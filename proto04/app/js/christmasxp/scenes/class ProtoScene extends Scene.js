var ProtoScene,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

ProtoScene = (function(_super) {
  __extends(ProtoScene, _super);

  function ProtoScene() {
    this.onMouseUp = __bind(this.onMouseUp, this);
    this.onMouseMove = __bind(this.onMouseMove, this);
    this.onMouseDown = __bind(this.onMouseDown, this);
    this.onTouchEnd = __bind(this.onTouchEnd, this);
    this.onTouchMove = __bind(this.onTouchMove, this);
    this.onTouchStart = __bind(this.onTouchStart, this);
    this.onMouseMoveConstant = __bind(this.onMouseMoveConstant, this);
    this.vx = this.vy = 0;
    this.constantVy = 0;
    this.lastX = this.lastY = 0;
    this.friction = 0.98;
    this.maxSpeed = 15;
    this.height = 1200;
    this.radius = 200;
    this.camRadius = 500;
    this.camAngle = 0;
    this.camAngleAuto = false;
    this.navTopBottom = false;
    this.createLights();
    this.createMountain();
    this.createExperiments();
    this.createGround();
    this.createTree();
    this.initGUI();
    Stage3d.scene.fog = new THREE.Fog(0xFAFAFF, 0, 3000);
    Stage3d.renderer.setClearColor(0xFAFAFF, 1);
    this.addEvents();
    return;
  }

  ProtoScene.prototype.createLights = function() {
    this.ambient = new THREE.AmbientLight(0x444444);
    this.directional = new THREE.DirectionalLight(0x6666AA, .3);
    this.directional.position.set(.5, 1, .5);
    this.cameraLight = new THREE.PointLight(0xffffff, 1, 800);
    this.cameraLight.position.set(0, 0, 0);
    Stage3d.add(this.ambient);
    Stage3d.add(this.directional);
    Stage3d.add(this.cameraLight);
  };

  ProtoScene.prototype.createMountain = function() {
    var geometry, material, mesh;
    material = new THREE.MeshLambertMaterial({
      color: 0x99FFFF,
      wireframe: false,
      lights: true,
      transparent: true,
      opacity: .9
    });
    geometry = new THREE.CylinderGeometry(0, this.radius, this.height, 32, 32);
    mesh = new THREE.Mesh(geometry, material);
    mesh.position.y = this.height / 2;
    Stage3d.add(mesh);
    return mesh;
  };

  ProtoScene.prototype.createExperiments = function() {
    var angle, geometry, i, material, mesh, percent, _i;
    this.xpMesh = [];
    for (i = _i = 0; _i < 24; i = _i += 1) {
      percent = (((i + 1) / 24) * .9 + .05) * .9;
      material = new THREE.MeshBasicMaterial({
        color: 0xFFFF11,
        wireframe: false,
        transparent: true,
        opacity: 1
      });
      geometry = new THREE.SphereGeometry(5, 8, 8, 8);
      mesh = new THREE.Mesh(geometry, material);
      angle = percent * Math.PI * 6;
      mesh.position.x = Math.cos(angle) * this.radius * (1 - percent);
      mesh.position.y = this.height * percent;
      mesh.position.z = Math.sin(angle) * this.radius * (1 - percent);
      Stage3d.add(mesh);
      this.xpMesh.push(mesh);
    }
  };

  ProtoScene.prototype.createBackScreen = function() {
    var geometry, material, mesh;
    material = new THREE.MeshBasicMaterial({
      color: 0xFFFFFF,
      wireframe: false,
      transparent: true,
      opacity: 1,
      fog: false,
      light: false,
      map: THREE.ImageUtils.loadTexture("img/map.jpg")
    });
    geometry = new THREE.PlaneBufferGeometry(160 * 10, 90 * 10, 10, 10);
    mesh = new THREE.Mesh(geometry, material);
    mesh.position.set(0, 0, -this.radius * 1.3);
    this.backScreen = mesh;
    Stage3d.add(mesh);
  };

  ProtoScene.prototype.createGround = function() {
    var geometry, i, material, mesh, _i, _ref;
    material = new THREE.MeshLambertMaterial({
      color: 0xFFFFFF,
      lights: true
    });
    geometry = new THREE.PlaneBufferGeometry(10000, 10000, 128, 128);
    geometry.dynamic = true;
    for (i = _i = 1, _ref = geometry.attributes.position.array.length; _i < _ref; i = _i += 3) {
      geometry.attributes.position.array[i + 1] += 100 * Math.random();
    }
    geometry.attributes.position.needsUpdate = true;
    geometry.attributes.normal.needsUpdate = true;
    geometry.computeTangents();
    geometry.computeVertexNormals();
    mesh = new THREE.Mesh(geometry, material);
    mesh.rotation.x -= Math.PI / 2;
    this.geometry = geometry;
    Stage3d.add(mesh);
  };

  ProtoScene.prototype.createTree = function() {};

  ProtoScene.prototype.update = function(dt) {
    if (this.navTopBottom) {
      this.vy += this.constantVy;
    }
    this.vy *= this.friction;
    this.vx *= this.friction;
    this.vx = Math.min(this.maxSpeed, this.vx);
    this.vy = Math.min(this.maxSpeed, this.vy);
    this.vx = Math.max(-this.maxSpeed, this.vx);
    this.vy = Math.max(-this.maxSpeed, this.vy);
    Stage3d.camera.position.y += this.vy;
    if (this.camAngleAuto) {
      this.camAngle = Stage3d.camera.position.y / this.height * Math.PI * 6;
    } else {
      this.camAngle += this.vx * 0.00005;
    }
    Stage3d.camera.position.x = Math.cos(this.camAngle) * this.camRadius;
    Stage3d.camera.position.z = Math.sin(this.camAngle) * this.camRadius;
    this.cameraLight.position.set(Stage3d.camera.position.x, Stage3d.camera.position.y, Stage3d.camera.position.z);
    this.updateExperiment();
  };

  ProtoScene.prototype.updateExperiment = function() {
    var currentXP, dist, dx, materialOff, materialOn, minDist, xp, _i, _j, _len, _len1, _ref, _ref1;
    materialOn = new THREE.MeshBasicMaterial({
      color: 0xFFFF11,
      wireframe: false,
      transparent: true,
      opacity: 1
    });
    materialOff = new THREE.MeshBasicMaterial({
      color: 0xFF0000,
      wireframe: false,
      transparent: true,
      opacity: 1
    });
    minDist = 10000000;
    currentXP = null;
    _ref = this.xpMesh;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      xp = _ref[_i];
      dx = xp.position.y - Stage3d.camera.position.y;
      dist = dx * dx;
      if (dist < minDist) {
        minDist = dist;
        currentXP = xp;
      }
    }
    _ref1 = this.xpMesh;
    for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
      xp = _ref1[_j];
      if (xp === currentXP) {
        xp.material = materialOn;
      } else {
        xp.material = materialOff;
      }
    }
  };

  ProtoScene.prototype.initGUI = function() {
    var gui;
    gui = new dat.GUI();
    gui.add(this, 'camAngleAuto');
    gui.add(this, 'navTopBottom');
    gui.add(this, 'camRadius', 200, 1000);
    gui.add(Stage3d.camera, 'fov', 0, 180);
    gui.add(this, 'friction', 0.95, 1);
  };

  ProtoScene.prototype.addEvents = function() {
    window.addEventListener('mousedown', this.onMouseDown);
    window.addEventListener('touchstart', this.onTouchStart);
    window.addEventListener('mousemove', this.onMouseMoveConstant);
  };

  ProtoScene.prototype.onMouseMoveConstant = function(e) {
    var y;
    y = (e.pageY / window.innerHeight) - .5;
    if (y > .2) {
      this.constantVy = -.8 * (y - .2);
    } else if (y < -.2) {
      this.constantVy = -.8 * (y + .2);
    } else {
      this.constantVy = 0;
    }
  };

  ProtoScene.prototype.onTouchStart = function(e) {
    this.lastX = e.touches[0].pageX;
    this.lastY = e.touches[0].pageY;
    window.addEventListener('touchend', this.onTouchUp);
    window.addEventListener('touchmove', this.onTouchMove);
  };

  ProtoScene.prototype.onTouchMove = function(e) {
    this.vx = e.touches[0].pageX - this.lastX;
    this.vy = e.touches[0].pageY - this.lastY;
    this.lastX = e.touches[0].pageX;
    this.lastY = e.touches[0].pageY;
  };

  ProtoScene.prototype.onTouchEnd = function(e) {
    window.removeEventListener('touchend', this.onTouchUp);
    window.removeEventListener('touchmove', this.onTouchMove);
  };

  ProtoScene.prototype.onMouseDown = function(e) {
    this.lastX = e.pageX;
    this.lastY = e.pageY;
    window.addEventListener('mouseup', this.onMouseUp);
    window.addEventListener('mousemove', this.onMouseMove);
  };

  ProtoScene.prototype.onMouseMove = function(e) {
    this.vx = e.pageX - this.lastX;
    this.vy = e.pageY - this.lastY;
    this.lastX = e.pageX;
    this.lastY = e.pageY;
  };

  ProtoScene.prototype.onMouseUp = function(e) {
    window.removeEventListener('mouseup', this.onMouseUp);
    window.removeEventListener('mousemove', this.onMouseMove);
  };

  return ProtoScene;

})(Scene);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNocmlzdG1hc3hwL3NjZW5lcy9jbGFzcyBQcm90b1NjZW5lIGV4dGVuZHMgU2NlbmUuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUEsVUFBQTtFQUFBOztpU0FBQTs7QUFBQTtBQUVDLCtCQUFBLENBQUE7O0FBQVksRUFBQSxvQkFBQSxHQUFBO0FBQ1gsaURBQUEsQ0FBQTtBQUFBLHFEQUFBLENBQUE7QUFBQSxxREFBQSxDQUFBO0FBQUEsbURBQUEsQ0FBQTtBQUFBLHFEQUFBLENBQUE7QUFBQSx1REFBQSxDQUFBO0FBQUEscUVBQUEsQ0FBQTtBQUFBLElBQUEsSUFBQyxDQUFBLEVBQUQsR0FBTSxJQUFDLENBQUEsRUFBRCxHQUFNLENBQVosQ0FBQTtBQUFBLElBQ0EsSUFBQyxDQUFBLFVBQUQsR0FBYyxDQURkLENBQUE7QUFBQSxJQUVBLElBQUMsQ0FBQSxLQUFELEdBQVMsSUFBQyxDQUFBLEtBQUQsR0FBUyxDQUZsQixDQUFBO0FBQUEsSUFHQSxJQUFDLENBQUEsUUFBRCxHQUFZLElBSFosQ0FBQTtBQUFBLElBSUEsSUFBQyxDQUFBLFFBQUQsR0FBWSxFQUpaLENBQUE7QUFBQSxJQUtBLElBQUMsQ0FBQSxNQUFELEdBQVUsSUFMVixDQUFBO0FBQUEsSUFNQSxJQUFDLENBQUEsTUFBRCxHQUFVLEdBTlYsQ0FBQTtBQUFBLElBT0EsSUFBQyxDQUFBLFNBQUQsR0FBYSxHQVBiLENBQUE7QUFBQSxJQVFBLElBQUMsQ0FBQSxRQUFELEdBQVksQ0FSWixDQUFBO0FBQUEsSUFTQSxJQUFDLENBQUEsWUFBRCxHQUFnQixLQVRoQixDQUFBO0FBQUEsSUFVQSxJQUFDLENBQUEsWUFBRCxHQUFnQixLQVZoQixDQUFBO0FBQUEsSUFZQSxJQUFDLENBQUEsWUFBRCxDQUFBLENBWkEsQ0FBQTtBQUFBLElBYUEsSUFBQyxDQUFBLGNBQUQsQ0FBQSxDQWJBLENBQUE7QUFBQSxJQWNBLElBQUMsQ0FBQSxpQkFBRCxDQUFBLENBZEEsQ0FBQTtBQUFB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QUF4QixFQUFrQyxJQUFDLENBQUEsU0FBbkMsQ0FGQSxDQUFBO0FBQUEsSUFHQSxNQUFNLENBQUMsZ0JBQVAsQ0FBd0IsV0FBeEIsRUFBb0MsSUFBQyxDQUFBLFdBQXJDLENBSEEsQ0FEVztFQUFBLENBcE1aLENBQUE7O0FBQUEsdUJBMk1BLFdBQUEsR0FBWSxTQUFDLENBQUQsR0FBQTtBQUNYLElBQUEsSUFBQyxDQUFBLEVBQUQsR0FBTSxDQUFDLENBQUMsS0FBRixHQUFVLElBQUMsQ0FBQSxLQUFqQixDQUFBO0FBQUEsSUFDQSxJQUFDLENBQUEsRUFBRCxHQUFNLENBQUMsQ0FBQyxLQUFGLEdBQVUsSUFBQyxDQUFBLEtBRGpCLENBQUE7QUFBQSxJQUVBLElBQUMsQ0FBQSxLQUFELEdBQVMsQ0FBQyxDQUFDLEtBRlgsQ0FBQTtBQUFBLElBR0EsSUFBQyxDQUFBLEtBQUQsR0FBUyxDQUFDLENBQUMsS0FIWCxDQURXO0VBQUEsQ0EzTVosQ0FBQTs7QUFBQSx1QkFrTkEsU0FBQSxHQUFVLFNBQUMsQ0FBRCxHQUFBO0FBQ1QsSUFBQSxNQUFNLENBQUMsbUJBQVAsQ0FBMkIsU0FBM0IsRUFBcUMsSUFBQyxDQUFBLFNBQXRDLENBQUEsQ0FBQTtBQUFBLElBQ0EsTUFBTSxDQUFDLG1CQUFQLENBQTJCLFdBQTNCLEVBQXVDLElBQUMsQ0FBQSxXQUF4QyxDQURBLENBRFM7RUFBQSxDQWxOVixDQUFBOztvQkFBQTs7R0FGd0IsTUFBekIsQ0FBQSIsImZpbGUiOiJjaHJpc3RtYXN4cC9zY2VuZXMvY2xhc3MgUHJvdG9TY2VuZSBleHRlbmRzIFNjZW5lLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgUHJvdG9TY2VuZSBleHRlbmRzIFNjZW5lXG5cblx0Y29uc3RydWN0b3I6KCktPlxuXHRcdEB2eCA9IEB2eSA9IDBcblx0XHRAY29uc3RhbnRWeSA9IDBcblx0XHRAbGFzdFggPSBAbGFzdFkgPSAwXG5cdFx0QGZyaWN0aW9uID0gMC45OFxuXHRcdEBtYXhTcGVlZCA9IDE1XG5cdFx0QGhlaWdodCA9IDEyMDBcblx0XHRAcmFkaXVzID0gMjAwXG5cdFx0QGNhbVJhZGl1cyA9IDUwMFxuXHRcdEBjYW1BbmdsZSA9IDBcblx0XHRAY2FtQW5nbGVBdXRvID0gZmFsc2Vcblx0XHRAbmF2VG9wQm90dG9tID0gZmFsc2VcblxuXHRcdEBjcmVhdGVMaWdodHMoKVxuXHRcdEBjcmVhdGVNb3VudGFpbigpXG5cdFx0QGNyZWF0ZUV4cGVyaW1lbnRzKClcblx0XHQjIEBjcmVhdGVCYWNrU2NyZWVuKClcblx0XHRAY3JlYXRlR3JvdW5kKClcblx0XHRAY3JlYXRlVHJlZSgpXG5cblx0XHRAaW5pdEdVSSgpXG5cblx0XHRTdGFnZTNkLnNjZW5lLmZvZyA9IG5ldyBUSFJFRS5Gb2coIDB4RkFGQUZGLCAwLCAzMDAwIClcblx0XHRTdGFnZTNkLnJlbmRlcmVyLnNldENsZWFyQ29sb3IoMHhGQUZBRkYsIDEpO1xuXG5cblx0XHRAYWRkRXZlbnRzKClcblx0XHRyZXR1cm5cblxuXHRjcmVhdGVMaWdodHM6KCktPlxuXHRcdEBhbWJpZW50ID0gbmV3IFRIUkVFLkFtYmllbnRMaWdodCggMHg0NDQ0NDQgKVxuXHRcdEBkaXJlY3Rpb25hbCA9IG5ldyBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0KCAweDY2NjZBQSwgLjMgKVxuXHRcdEBkaXJlY3Rpb25hbC5wb3NpdGlvbi5zZXQoIC41LCAxLCAuNSApXG5cdFx0QGNhbWVyYUxpZ2h0ID0gbmV3IFRIUkVFLlBvaW50TGlnaHQoIDB4ZmZmZmZmLCAxLCA4MDAgKVxuXHRcdEBjYW1lcmFMaWdodC5wb3NpdGlvbi5zZXQoIDAsIDAsIDAgKVxuXHRcdFN0YWdlM2QuYWRkKEBhbWJpZW50KVxuXHRcdFN0YWdlM2QuYWRkKEBkaXJlY3Rpb25hbClcblx0XHRTdGFnZTNkLmFkZChAY2FtZXJhTGlnaHQpXG5cdFx0cmV0dXJuXG5cblx0Y3JlYXRlTW91bnRhaW46KCktPlxuXHRcdG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwoe2NvbG9yOjB4OTlGRkZGLCB3aXJlZnJhbWU6ZmFsc2UsbGlnaHRzOnRydWUsIHRyYW5zcGFyZW50OnRydWUsIG9wYWNpdHk6Ljl9KVxuXHRcdGdlb21ldHJ5ID0gIG5ldyBUSFJFRS5DeWxpbmRlckdlb21ldHJ5KDAsIEByYWRpdXMsIEBoZWlnaHQsIDMyLCAzMilcblx0XHRtZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKVxuXHRcdG1lc2gucG9zaXRpb24ueSA9IEBoZWlnaHQvMlxuXHRcdFN0YWdlM2QuYWRkKG1lc2gpXG5cdFx0cmV0dXJuIG1lc2hcblxuXHRjcmVhdGVFeHBlcmltZW50czooKS0+XG5cdFx0QHhwTWVzaCA9IFtdXG5cdFx0Zm9yIGkgaW4gWzAuLi4yNF0gYnkgMVxuXHRcdFx0cGVyY2VudCA9ICgoKGkrMSkvMjQpKi45Ky4wNSkqLjlcblx0XHRcdG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtjb2xvcjoweEZGRkYxMSwgd2lyZWZyYW1lOmZhbHNlLCB0cmFuc3BhcmVudDp0cnVlLCBvcGFjaXR5OjF9KVxuXHRcdFx0Z2VvbWV0cnkgPSAgbmV3IFRIUkVFLlNwaGVyZUdlb21ldHJ5KDUsIDgsIDgsIDgpXG5cdFx0XHRtZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKVxuXHRcdFx0YW5nbGUgPSBwZXJjZW50Kk1hdGguUEkqNlxuXHRcdFx0bWVzaC5wb3NpdGlvbi54ID0gTWF0aC5jb3MoYW5nbGUpKkByYWRpdXMqKDEtcGVyY2VudClcblx0XHRcdG1lc2gucG9zaXRpb24ueSA9IEBoZWlnaHQqcGVyY2VudFxuXHRcdFx0bWVzaC5wb3NpdGlvbi56ID0gTWF0aC5zaW4oYW5nbGUpKkByYWRpdXMqKDEtcGVyY2VudClcblx0XHRcdFN0YWdlM2QuYWRkKG1lc2gpXG5cdFx0XHRAeHBNZXNoLnB1c2gobWVzaClcblx0XHRyZXR1cm5cblxuXHRjcmVhdGVCYWNrU2NyZWVuOigpLT5cblx0XHRtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCh7Y29sb3I6MHhGRkZGRkYsIHdpcmVmcmFtZTpmYWxzZSwgdHJhbnNwYXJlbnQ6IHRydWUsIG9wYWNpdHk6MSwgZm9nOmZhbHNlLCBsaWdodDpmYWxzZSwgbWFwOlRIUkVFLkltYWdlVXRpbHMubG9hZFRleHR1cmUoIFwiaW1nL21hcC5qcGdcIiApO30pXG5cdFx0Z2VvbWV0cnkgPSAgbmV3IFRIUkVFLlBsYW5lQnVmZmVyR2VvbWV0cnkoMTYwKjEwLCA5MCoxMCwgMTAsIDEwKVxuXHRcdCMgZm9yIGkgaW4gWzEuLi5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5Lmxlbmd0aF0gYnkgM1xuXHRcdCMgXHRnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLmFycmF5W2krMV0gKz0gTWF0aC5jb3MoaS8xMjApKjIwXG5cdFx0IyBnZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZVxuXHRcdCMgZ2VvbWV0cnkuYXR0cmlidXRlcy5ub3JtYWwubmVlZHNVcGRhdGUgPSB0cnVlXG5cdFx0IyBnZW9tZXRyeS5jb21wdXRlVGFuZ2VudHMoKTtcblx0XHQjIGdlb21ldHJ5LmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKClcblx0XHRtZXNoID0gbmV3IFRIUkVFLk1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKVxuXHRcdG1lc2gucG9zaXRpb24uc2V0KDAsMCwtQHJhZGl1cyoxLjMpXG5cdFx0QGJhY2tTY3JlZW4gPSBtZXNoXG5cdFx0U3RhZ2UzZC5hZGQobWVzaClcblx0XHRyZXR1cm5cblxuXHRjcmVhdGVHcm91bmQ6KCktPlxuXHRcdG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwoe2NvbG9yOjB4RkZGRkZGLCBsaWdodHM6dHJ1ZX0pXG5cdFx0Z2VvbWV0cnkgPSAgbmV3IFRIUkVFLlBsYW5lQnVmZmVyR2VvbWV0cnkoMTAwMDAsIDEwMDAwLCAxMjgsIDEyOClcblx0XHRnZW9tZXRyeS5keW5hbWljID0gdHJ1ZVxuXHRcdGZvciBpIGluIFsxLi4uZ2VvbWV0cnkuYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheS5sZW5ndGhdIGJ5IDNcblx0XHRcdGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXlbaSsxXSArPSAxMDAqTWF0aC5yYW5kb20oKVxuXHRcdGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlXG5cdFx0Z2VvbWV0cnkuYXR0cmlidXRlcy5ub3JtYWwubmVlZHNVcGRhdGUgPSB0cnVlXG5cdFx0Z2VvbWV0cnkuY29tcHV0ZVRhbmdlbnRzKCk7XG5cdFx0Z2VvbWV0cnkuY29tcHV0ZVZlcnRleE5vcm1hbHMoKVxuXG5cdFx0IyBjb25zb2xlLmxvZyBnZW9tZXRyeVxuXHRcdG1lc2ggPSBuZXcgVEhSRUUuTWVzaChnZW9tZXRyeSwgbWF0ZXJpYWwpXG5cdFx0bWVzaC5yb3RhdGlvbi54IC09IE1hdGguUEkvMlxuXG5cdFx0QGdlb21ldHJ5ID0gZ2VvbWV0cnlcblx0XHRTdGFnZTNkLmFkZChtZXNoKVxuXHRcdHJldHVyblxuXG5cdGNyZWF0ZVRyZWU6KCktPlxuXHRcdHJldHVyblxuXG5cdHVwZGF0ZTooZHQpLT5cblx0XHRpZiBAbmF2VG9wQm90dG9tXG5cdFx0XHRAdnkgKz0gQGNvbnN0YW50Vnlcblx0XHRAdnkgKj0gQGZyaWN0aW9uXG5cdFx0QHZ4ICo9IEBmcmljdGlvblxuXHRcdEB2eCA9IE1hdGgubWluKEBtYXhTcGVlZCxAdngpXG5cdFx0QHZ5ID0gTWF0aC5taW4oQG1heFNwZWVkLEB2eSlcblx0XHRAdnggPSBNYXRoLm1heCgtQG1heFNwZWVkLEB2eClcblx0XHRAdnkgPSBNYXRoLm1heCgtQG1heFNwZWVkLEB2eSlcblxuXHRcdFN0YWdlM2QuY2FtZXJhLnBvc2l0aW9uLnkgKz0gQHZ5XG5cdFx0aWYgQGNhbUFuZ2xlQXV0b1xuXHRcdFx0QGNhbUFuZ2xlID0gU3RhZ2UzZC5jYW1lcmEucG9zaXRpb24ueS9AaGVpZ2h0Kk1hdGguUEkqNlxuXHRcdGVsc2Vcblx0XHRcdEBjYW1BbmdsZSArPSBAdngqMC4wMDAwNVxuXG5cdFx0U3RhZ2UzZC5jYW1lcmEucG9zaXRpb24ueCA9IE1hdGguY29zKEBjYW1BbmdsZSkqQGNhbVJhZGl1c1xuXHRcdFN0YWdlM2QuY2FtZXJhLnBvc2l0aW9uLnogPSBNYXRoLnNpbihAY2FtQW5nbGUpKkBjYW1SYWRpdXNcbiBcblx0XHQjIEBiYWNrU2NyZWVuLnBvc2l0aW9uLnkgPSBTdGFnZTNkLmNhbWVyYS5wb3NpdGlvbi55IFxuXHRcdCMgQGJhY2tTY3JlZW4ucG9zaXRpb24ueCA9IE1hdGguY29zKEBjYW1BbmdsZS1NYXRoLlBJKSpAY2FtUmFkaXVzXG5cdFx0IyBAYmFja1NjcmVlbi5wb3NpdGlvbi56ID0gTWF0aC5zaW4oQGNhbUFuZ2xlLU1hdGguUEkpKkBjYW1SYWRpdXNcblx0XHQjIEBiYWNrU2NyZWVuLmxvb2tBdChuZXcgVEhSRUUuVmVjdG9yMygwLEBiYWNrU2NyZWVuLnBvc2l0aW9uLnksMCkpXG5cblx0XHQjIEBiYWNrU2NyZWVuLnBvc2l0aW9uLnggPSBNYXRoLmNvcyhAY2FtQW5nbGUrLjQpKkBjYW1SYWRpdXMqLjRcblx0XHQjIEBiYWNrU2NyZWVuLnBvc2l0aW9uLnkgPSBTdGFnZTNkLmNhbWVyYS5wb3NpdGlvbi55XG5cdFx0IyBAYmFja1NjcmVlbi5wb3NpdGlvbi56ID0gTWF0aC5zaW4oQGNhbUFuZ2xlKy40KSpAY2FtUmFkaXVzKi40XG5cdFx0IyBAYmFja1NjcmVlbi5sb29rQXQoU3RhZ2UzZC5jYW1lcmEucG9zaXRpb24pXG5cblx0XHRAY2FtZXJhTGlnaHQucG9zaXRpb24uc2V0KFN0YWdlM2QuY2FtZXJhLnBvc2l0aW9uLngsU3RhZ2UzZC5jYW1lcmEucG9zaXRpb24ueSxTdGFnZTNkLmNhbWVyYS5wb3NpdGlvbi56KVxuXHRcdEB1cGRhdGVFeHBlcmltZW50KClcblx0XHRyZXR1cm5cblxuXHR1cGRhdGVFeHBlcmltZW50OigpLT5cblx0XHRtYXRlcmlhbE9uID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtjb2xvcjoweEZGRkYxMSwgd2lyZWZyYW1lOmZhbHNlLCB0cmFuc3BhcmVudDp0cnVlLCBvcGFjaXR5OjF9KVxuXHRcdG1hdGVyaWFsT2ZmID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtjb2xvcjoweEZGMDAwMCwgd2lyZWZyYW1lOmZhbHNlLCB0cmFuc3BhcmVudDp0cnVlLCBvcGFjaXR5OjF9KVxuXHRcdG1pbkRpc3QgPSAxMDAwMDAwMFxuXHRcdGN1cnJlbnRYUCA9IG51bGxcblx0XHRmb3IgeHAgaW4gQHhwTWVzaFxuXHRcdFx0ZHggPSB4cC5wb3NpdGlvbi55LVN0YWdlM2QuY2FtZXJhLnBvc2l0aW9uLnlcblx0XHRcdGRpc3QgPSBkeCpkeFxuXHRcdFx0aWYgZGlzdDxtaW5EaXN0XG5cdFx0XHRcdG1pbkRpc3QgPSBkaXN0XG5cdFx0XHRcdGN1cnJlbnRYUCA9IHhwXG5cdFx0Zm9yIHhwIGluIEB4cE1lc2hcblx0XHRcdGlmIHhwID09IGN1cnJlbnRYUFxuXHRcdFx0XHR4cC5tYXRlcmlhbCA9IG1hdGVyaWFsT25cblx0XHRcdGVsc2Vcblx0XHRcdFx0eHAubWF0ZXJpYWwgPSBtYXRlcmlhbE9mZlxuXHRcdHJldHVyblxuXG5cdGluaXRHVUk6KCktPlxuXHRcdGd1aSA9IG5ldyBkYXQuR1VJKClcblx0XHRndWkuYWRkKEAsJ2NhbUFuZ2xlQXV0bycpXG5cdFx0Z3VpLmFkZChALCduYXZUb3BCb3R0b20nKVxuXHRcdGd1aS5hZGQoQCwnY2FtUmFkaXVzJywyMDAsMTAwMClcblx0XHRndWkuYWRkKFN0YWdlM2QuY2FtZXJhLCdmb3YnLDAsMTgwKVxuXHRcdGd1aS5hZGQoQCwnZnJpY3Rpb24nLDAuOTUsMSlcblx0XHRyZXR1cm5cblxuXHRhZGRFdmVudHM6KCktPlxuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLEBvbk1vdXNlRG93bilcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsQG9uVG91Y2hTdGFydClcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJyxAb25Nb3VzZU1vdmVDb25zdGFudClcblx0XHQjIHRvZG8gZG8gc2FtZSB3aXRoIGFjY2VsZXJvbWV0ZXJcblx0XHQjIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JyxAb25Ub3VjaFN0YXJ0KVxuXHRcdHJldHVyblxuXG5cdG9uTW91c2VNb3ZlQ29uc3RhbnQ6KGUpPT5cblx0XHQjIHggPSAoZS5wYWdlWC93aW5kb3cuaW5uZXJXaWR0aCktLjVcblx0XHR5ID0gKGUucGFnZVkvd2luZG93LmlubmVySGVpZ2h0KS0uNVxuXHRcdFxuXHRcdGlmKHkgPiAuMikgdGhlbiBAY29uc3RhbnRWeSA9IC0uOCooeS0uMilcblx0XHRlbHNlIGlmKHkgPCAtLjIpIHRoZW4gQGNvbnN0YW50VnkgPSAtLjgqKHkrLjIpXG5cdFx0ZWxzZSBAY29uc3RhbnRWeSA9IDBcblx0XHRyZXR1cm5cblxuXHRvblRvdWNoU3RhcnQ6KGUpPT5cblx0XHRAbGFzdFggPSBlLnRvdWNoZXNbMF0ucGFnZVg7XG5cdFx0QGxhc3RZID0gZS50b3VjaGVzWzBdLnBhZ2VZO1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsQG9uVG91Y2hVcClcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJyxAb25Ub3VjaE1vdmUpXG5cdFx0cmV0dXJuXG5cblx0b25Ub3VjaE1vdmU6KGUpPT5cblx0XHRAdnggPSBlLnRvdWNoZXNbMF0ucGFnZVggLSBAbGFzdFhcblx0XHRAdnkgPSBlLnRvdWNoZXNbMF0ucGFnZVkgLSBAbGFzdFlcblx0XHRAbGFzdFggPSBlLnRvdWNoZXNbMF0ucGFnZVg7XG5cdFx0QGxhc3RZID0gZS50b3VjaGVzWzBdLnBhZ2VZO1xuXHRcdHJldHVyblxuXG5cdG9uVG91Y2hFbmQ6KGUpPT5cblx0XHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLEBvblRvdWNoVXApXG5cdFx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsQG9uVG91Y2hNb3ZlKVxuXHRcdHJldHVyblxuXG5cdG9uTW91c2VEb3duOihlKT0+XG5cdFx0QGxhc3RYID0gZS5wYWdlWDtcblx0XHRAbGFzdFkgPSBlLnBhZ2VZO1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJyxAb25Nb3VzZVVwKVxuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLEBvbk1vdXNlTW92ZSlcblx0XHRyZXR1cm5cblxuXHRvbk1vdXNlTW92ZTooZSk9PlxuXHRcdEB2eCA9IGUucGFnZVggLSBAbGFzdFhcblx0XHRAdnkgPSBlLnBhZ2VZIC0gQGxhc3RZXG5cdFx0QGxhc3RYID0gZS5wYWdlWDtcblx0XHRAbGFzdFkgPSBlLnBhZ2VZO1xuXHRcdHJldHVyblxuXG5cdG9uTW91c2VVcDooZSk9PlxuXHRcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJyxAb25Nb3VzZVVwKVxuXHRcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLEBvbk1vdXNlTW92ZSlcblx0XHRyZXR1cm5cblxuIl19