!function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var o,i,r,s,a,u=function(t,e){return function(){return t.apply(e,arguments)}};s=n(2),r=n(4),a=n(1),i=n(3),window.PI=Math.PI,window.TWO_PI=2*Math.PI,window.HALF_PI=Math.PI/2,window.delay=function(t,e){return setTimeout(e,1e3*t)},Number.prototype.map=function(t,e,n,o){return(this-t)*(o-n)/(e-t)+n},o=function(){function t(){this.setup=u(this.setup,this),window.c=s,c.enable=!a.live,r.once("loaded",this.setup),r.load()}return t.prototype.setup=function(){var t;return i.set_tests(["desktop","WebGL","mp3","wav","ogg"]),i.supported()?n(6):(t=n(5),void t.show())},t}(),t.exports=$(function(){return new o})},function(t,e,n){var o,i,r;r=new MobileDetect(window.navigator.userAgent),t.exports={live:!0,debug:!1,base_path:"",retina:2===window.devicePixelRatio,fog:!0},i=n(7),o=i.addFolder("app"),o.add(t.exports,"debug")},function(t){var e=[].slice;t.exports={enable:!1,clear:function(){return"undefined"!=typeof console&&null!==console&&null!=console.clear?console.clear():void 0},log:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.log&&null!=console.log.apply?console.log.apply(console,t):console.log(t):void 0},debug:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.debug&&null!=console.debug.apply?console.debug.apply(console,t):console.log(t):void 0},info:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.info&&null!=console.info.apply?console.info.apply(console,t):console.log(t):void 0},warn:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.warn&&null!=console.warn.apply?console.warn.apply(console,t):console.log(t):void 0},error:function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this.enable?"undefined"!=typeof console&&null!==console&&null!=console.error&&null!=console.error.apply?console.error.apply(console,t):console.log(t):void 0}}},function(t,e,n){var o;o=n(4),t.exports=new(function(){function t(){this.detect=new MobileDetect(window.navigator.userAgent),this.tests={},this.messages={WebGL:"WebGL",desktop:"Desktop Browser",tablet:"Tablet Browser",mobile:"Mobile Browser"}}return t.prototype.set_tests=function(t){var e,n,o,i,r;for(r=[],o=0,i=t.length;i>o;o++)switch(n=t[o]){case"desktop":r.push(this.detect.tablet()&&this.detect.mobile()?this.tests.desktop=!1:this.tests.desktop=!0);break;case"tablet":r.push(this.tests.tablet=this.detect.tablet());break;case"mobile":r.push(this.tests.mobile=this.detect.mobile());break;case"AudioContext":r.push(this.tests.AudioContext=window.AudioContext||window.webkitAudioContext);break;case"WebGL":e=function(){var t;try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(e){return t=e,!1}},r.push(this.tests.WebGL=e());break;case"mp3":r.push(this.tests.mp3=Modernizr.audio.mp3);break;case"ogg":r.push(this.tests.ogg=Modernizr.audio.ogg);break;default:r.push(void 0)}return r},t.prototype.supported=function(){var t,e,n,o,i;t=!1,this.fails=[],o=this.tests;for(n in o)e=o[n],e||this.fails.push(this.messages[n]);this.fails.length<1&&(t=!0),i=this.tests;for(n in i){if(e=i[n],e===!1){t=!1;break}"desktop"!==n&&"tablet"!==n&&"mobile"!==n||!e||(t=!0)}return t},t.prototype.unsupported=function(){var t,e;return e=n(37),t={fails:this.fails,dictionary:o},$("body").css({"background-image":'url("screenshot.jpg")'}),$("body").append(e(t))},t}())},function(t,e,n){var o,i,r,s;r=n(21),s=n(1),i=n(19),o=function(){function t(){r(this),this.objs={}}return t.prototype.default_dictionary="dictionary.xml",t.prototype.load=function(){var t;return t=new i,t.on("loading",function(){return function(t){return c.info("[ PERCENT LOADED ] ->",t)}}(this)),t.once("loaded",function(t){return function(e){var n,o,i;for(o=0,i=e.length;i>o;o++)n=e[o],t.objs[n.id]=$(n.data);return t.emit("loaded")}}(this)),t.add("dictionary.xml",""+s.base_path+"xml/dictionary.xml","xml"),t.load()},t.prototype.get=function(t,e){var n;return null==e&&(e=this.default_dictionary),n=this.get_raw(t,e),n?n.text():""},t.prototype.get_raw=function(t,e){return null==e&&(e=this.default_dictionary),this.objs[e].find(t).length?this.objs[e].find(t):!1},t.prototype.get_dictionary=function(t){return null==t&&(t=this.default_dictionary),this.objs[t]},t}(),t.exports=new o},function(t,e,n){var o,i,r,s,a,u;i=n(21),s=n(1),o=n(4),a=n(8),r=n(9),u=n(10),t.exports=new(function(){function t(){var t,e,r,a,u;i(this),this.ui={title:"h1",intro:".intro p",img:"img"},a=n(37),r={dictionary:o,base_path:s.base_path},$("body").append(a(r)),this.el=$("#unsupported_screen"),u=this.ui;for(e in u)t=u[e],this.ui[e]=this.el.find(t);this.ui.title_letters=this.ui.title.lettering().children(),this.ui.intro_letters=this.ui.intro.lettering().children()}return t.prototype.show=function(){var t;return TweenLite.to(this.el,1,{autoAlpha:1}),this.ui.title_letters.each(function(t,e){var n,o;return n=u.random(0,2400),o=u.random(1e3,2e3),$(e).delay(n).animate({opacity:1},o)}),t=1e3,this.ui.intro_letters.each(function(e,n){var o;return t=u.random(0,2e3),o=u.random(1e3,2e3),$(n).delay(t).animate({opacity:1},o)})},t}())},function(t,e,n){var o,i,r,s,a,u,l,d,h,p,f,_,m,g=function(t,e){return function(){return t.apply(e,arguments)}};f=n(1),s=n(11),p=n(12),h=n(13),a=n(14),m=n(15),r=n(16),d=n(21),l=n(7),o=n(20),_=n(17),u=n(18),t.exports=new(i=function(){function t(){this._resize=g(this._resize,this),this._update=g(this._update,this),this.game_ended=g(this.game_ended,this),this.game_start=g(this.game_start,this),this.game_ready=g(this.game_ready,this),this.reset_game=g(this.reset_game,this);var t;d(this),this.el=$("#app"),t=function(t,e){return t.position.set(1*e,.75*e,1*e),t.lookAt(new THREE.Vector3)},t(s.dev,60),h.setSize(m.width,m.height),h.shadowMapEnabled=!0,this.el.append(h.domElement),f.debug&&(p.add(new THREE.GridHelper(50,10)),p.add(new THREE.AxisHelper(10))),f.fog&&l.add(p.fog,"density",0,.1),this.game=new o,this._bind(),this.reset_game()}return t.prototype.game=null,t.prototype._bind=function(){return m.on("resize",this._resize),r.on("tick",this._update),u.on("replay",this.reset_game)},t.prototype.reset_game=function(){return _.show(),this.game.is_loaded?this.game_ready():(this.game.once("loaded",this.game_ready),this.game.load())},t.prototype.game_ready=function(){return _.hide_loading(),_.once("start",this.game_start),c.log("start game")},t.prototype.game_start=function(){return _.hide(),this.game.once("ended",this.game_ended),this.game.start()},t.prototype.game_ended=function(){return c.log("game ended"),u.render_result(),u.show(),u.once("replay",this.game_start)},t.prototype._update=function(){return a.update(),f.debug?(this._render(s.dev,0,0,1,1),this._render(s.user,0,0,.25,.25)):this._render(s.user,0,0,1,1)},t.prototype._render=function(t,e,n,o,i){return e*=m.width,n*=m.height,o*=m.width,i*=m.height,s.dev.updateProjectionMatrix(),s.user.updateProjectionMatrix(),h.setViewport(e,n,o,i),h.setScissor(e,n,o,i),h.enableScissorTest(!0),h.setClearColor(1184274),h.render(p,t)},t.prototype._resize=function(){return s.dev.aspect=m.width/m.height,s.user.aspect=m.width/m.height,s.dev.updateProjectionMatrix(),s.user.updateProjectionMatrix(),h.setSize(m.width,m.height)},t}())},function(t,e,n){var o,i,r,s;r=n(46),s=n(1),s.live?(o=function(){function t(){}return t.prototype.add=function(){return this},t.prototype.listen=function(){return this},t.prototype.name=function(){return this},t.prototype.open=function(){return this},t.prototype.onChange=function(){return this},t}(),i=function(){function t(){}return t.prototype.add=function(){return this},t.prototype.addFolder=function(){return new o},t.prototype.name=function(){return this},t.prototype.close=function(){return this},t.prototype.step=function(){return this},t.prototype.onChange=function(){return this},t.prototype.setValue=function(){return this},t}(),t.exports=new i):t.exports=new r.GUI},function(t){var e,n=function(t,e){return function(){return t.apply(e,arguments)}};e=function(){function t(){this.weibo=n(this.weibo,this),this.renren=n(this.renren,this),this.twitter=n(this.twitter,this),this.facebook=n(this.facebook,this),this.tumblr=n(this.tumblr,this),this.pinterest=n(this.pinterest,this),this.plus=n(this.plus,this),this.open_window=n(this.open_window,this),this.url=window.location.href}return t.prototype.open_window=function(t,e,n){var o,i;return o=screen.availWidth-e>>1,i=screen.availHeight-n>>1,window.open(t,"","top="+i+",left="+o+",width="+e+",height="+n+",location=no,menubar=no"),!1},t.prototype.plus=function(t){return t=encodeURIComponent(t||this.url),this.open_window("https://plus.google.com/share?url="+t,650,385),!1},t.prototype.pinterest=function(t,e,n){return t=encodeURIComponent(t||this.url),e=encodeURIComponent(e),n=encodeURIComponent(n),this.open_window("http://www.pinterest.com/pin/create/button/?url="+t+"&media="+e+"&description="+n,735,310),!1},t.prototype.tumblr=function(t,e,n){return t=encodeURIComponent(t||this.url),e=encodeURIComponent(e),n=encodeURIComponent(n),this.open_window("http://www.tumblr.com/share/photo?source="+e+"&caption="+n+"&click_thru="+t,450,430),!1},t.prototype.facebook=function(t,e){var n;return null==e&&(e=""),t=encodeURIComponent(t||this.url),n=encodeURIComponent(e),this.open_window("http://www.facebook.com/share.php?u="+t+"&t="+n,600,300),!1},t.prototype.twitter=function(t,e){var n;return null==e&&(e=""),t=encodeURIComponent(t||this.url),""===e&&(e="Generic share text here!"),n=encodeURIComponent(e),this.open_window("http://twitter.com/intent/tweet/?text="+n+"&url="+t,600,300),!1},t.prototype.renren=function(t){return t=encodeURIComponent(t||this.url),this.open_window("http://share.renren.com/share/buttonshare.do?link="+t,600,300),!1},t.prototype.weibo=function(t){return t=encodeURIComponent(t||this.url),this.open_window("http://service.weibo.com/share/share.php?url="+t+"&language=zh_cn",600,300),!1},t}(),t.exports=new e},function(t,e,n){var o;o=n(21),t.exports=new(function(){function t(){o(this),this.reset()}return t.prototype.success=Boolean,t.prototype.finished=Boolean,t.prototype.user_clicked=Boolean,t.prototype.reset=function(){return this.finished=!1,this.success=!0,this.user_clicked=!1},t.prototype.set=function(t,e){return this[t]=e,this.emit(t,e)},t.prototype.get=function(t){return this[t]},t.prototype.game_completed=function(){return this.success?"success":"failed"},t}())},function(t,e,n){var o;o=n(12),t.exports={lerp:function(t,e,n){return t+(e-t)*n},random:function(t,e){return t+Math.random()*(e-t)},random_array_item:function(t){return t[Math.ceil(Math.random()*t.length)-1]},merge:function(t,e){var n,o,i,r;"object"!=typeof t&&(t={});for(i in e)if(e.hasOwnProperty(i)){if(r=e[i],"object"==typeof r){t[i]=this.merge(t[i],r);continue}t[i]=r}for(n=2,o=arguments.length;o>n;)merge(t,arguments[n]),n++;return t},gui_folder:function(t,e,n,o){var i,r;return null==o&&(o=100),i=t.addFolder(n),r=2*Math.PI,i.add(e.position,"x",-o,o),i.add(e.position,"y",-o,o),i.add(e.position,"z",-o,o),i.add(e.rotation,"x",-r,r).name("rotation x"),i.add(e.rotation,"y",-r,r).name("rotation y"),i.add(e.rotation,"z",-r,r).name("rotation z"),i.add(e.scale,"x",0,10).name("scale x"),i.add(e.scale,"y",0,10).name("scale y"),i.add(e.scale,"z",0,10).name("scale z"),i.open()},spline:function(t){var e,n,o,i;for(n=[],o=0,i=t.length;i>o;o++)e=t[o],n.push(e.clone());return new THREE.SplineCurve3(n)},path:function(t,e){var n,i,r,s,a,u,l,c,d,h,p,f,_;for(null==t&&(t=[]),null==e&&(e=16711680),u=function(){var e,n,o;for(o=[],i=e=0,n=t.length;n>=0?n>e:e>n;i=n>=0?++e:--e)o.push(""+i);return o}(),a=[],i=h=0,_=u.length;_>=0?_>h:h>_;i=_>=0?++h:--h)s=new THREE.Mesh(new THREE.SphereGeometry(1,16,16),new THREE.MeshBasicMaterial({color:e})),s.name="path_"+i,s.position.copy(t[i]),a.push(s);for(t=function(){var t,e,n;for(n=[],t=0,e=a.length;e>t;t++)s=a[t],n.push(s.position.clone());return n}(),d=this.spline(t),c=d.getPoints(50),n=new THREE.Geometry,p=0,f=c.length;f>p;p++)l=c[p],n.vertices.push(l.clone());return r=new THREE.Line(n,new THREE.LineBasicMaterial({color:e})),r.visible=!1,o.add(r),this.spline(c)},random_sphere_point:function(t,e,n,o){var i,r,s,a,u,l,c;return null==t&&(t=0),null==e&&(e=0),null==n&&(n=0),null==o&&(o=1),s=Math.random(),a=Math.random(),r=2*Math.PI*s,i=Math.acos(2*a-1),u=t+o*Math.sin(i)*Math.cos(r),l=e+o*Math.sin(i)*Math.sin(r),c=n+o*Math.cos(i),[u,l,c]}}},function(t,e,n){var o,i;i=n(15),o=n(7),e.user=new THREE.PerspectiveCamera(65,i.width/i.height,.1,1e5),e.dev=new THREE.PerspectiveCamera(65,i.width/i.height,.1,1e5),o=o.addFolder("cameras"),e.user.name="user",e.dev.name="dev",o.add(e.user,"name"),o.add(e.user,"fov",10,200).listen(),o.add(e.dev,"name"),o.add(e.dev,"fov",10,200).listen()},function(t,e,n){var o;o=n(1),t.exports=new THREE.Scene,o.fog&&(t.exports.fog=new THREE.FogExp2(0,.00325))},function(t){t.exports=new THREE.WebGLRenderer({antialias:!0})},function(t,e,n){var o,i,r,s,a;a=n(1),i=n(11),s=n(13),o=i.dev,r=new THREE.TrackballControls(o,$("canvas")[0]),r.rotateSpeed=1,r.zoomSpeed=1.2,r.panSpeed=.8,r.noZoom=!1,r.noPan=!1,r.staticMoving=!0,r.dynamicDampingFactor=.5,t.exports=r},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};i=n(21),o=function(){function t(){this.resize=r(this.resize,this),i(this),this.window.on("resize",this.resize),this.resize()}return t.prototype.window=$(window),t.prototype.width=0,t.prototype.height=0,t.prototype.resize=function(){return this.width=this.window.width(),this.height=this.window.height(),this.emit("resize")},t}(),t.exports=new o},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};i=n(21),function(){var t,e,n;for(t=0,e=["ms","moz","o"],n=0;n<e.length&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"],++n;return window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n,o,i;return n=(new Date).getTime(),i=Math.max(0,16-(n-t)),o=window.setTimeout(function(){return e(n+i)},i),t=n+i,o}),window.cancelAnimationFrame?void 0:window.cancelAnimationFrame=function(t){return clearTimeout(t)}}(),o=function(){function t(){this.animloop=r(this.animloop,this),i(this),this.start()}return t.prototype.id_animloop=null,t.prototype.start=function(){return this.id_animloop=window.requestAnimationFrame(this.animloop)},t.prototype.stop=function(){return window.cancelAnimationFrame(this.id_animloop),this.id_animloop=null},t.prototype.animloop=function(){return this.id_animloop=window.requestAnimationFrame(this.animloop),this.emit("tick")},t}(),t.exports=new o},function(t,e,n){var o,i,r,s,a=function(t,e){return function(){return t.apply(e,arguments)}};i=n(21),o=n(4),s=n(10),r=n(25),t.exports=new(function(){function t(){this.on_click=a(this.on_click,this);var t,e,r,s,u;i(this),this.ui={btn:"#btn",loading:"#loading",title:"h1",intro:".intro p"},s=n(38),r={dictionary:o},$("body").append(s(r)),this.el=$("#start_screen"),u=this.ui;for(e in u)t=u[e],this.ui[e]=this.el.find(t);this.ui.title_letters=this.ui.title.lettering().children(),this.ui.intro_letters=this.ui.intro.lettering().children(),this.bind()}return t.prototype.bind=function(){return this.ui.btn.on("click",this.on_click)},t.prototype.unbind=function(){return this.ui.btn.off("click",this.on_click)},t.prototype.on_click=function(t){return t.preventDefault(),this.emit("start")},t.prototype.hide_loading=function(){var t;return TweenLite.killTweensOf(this.ui.loading),t={autoAlpha:0,onComplete:function(t){return function(){return t.show_start()}}(this)},TweenLite.to(this.ui.loading,.5,t)},t.prototype.show_start=function(){var t;return r.fade_in(),r.play(),this.ui.title_letters.each(function(t,e){var n,o,i;return n=s.random(.2,1.4),o=s.random(2,3),i={opacity:1,ease:Power3.easeIn,delay:n},TweenLite.to(e,o,i)}),t=3e3,this.ui.intro_letters.each(function(e,n){var o;return t+=60,o=s.random(500,600),$(n).delay(t).animate({opacity:1},o)}).promise().done(function(t){return function(){var e;return e={autoAlpha:.75,ease:Power1.easeOut},TweenLite.to(t.ui.btn,1,e)}}(this))},t.prototype.show=function(){return TweenLite.to(this.el,.5,{autoAlpha:1})},t.prototype.hide=function(){var t;return t={autoAlpha:0,onComplete:function(t){return function(){return t.emit("hidden")}}(this)},TweenLite.to(this.el,.5,t)},t}())},function(t,e,n){var o,i,r,s,a,u,l,c=function(t,e){return function(){return t.apply(e,arguments)}};i=n(21),s=n(1),o=n(4),a=n(8),r=n(9),l=n(10),u=n(26),t.exports=new(function(){function t(){this.share=c(this.share,this),this.on_click=c(this.on_click,this);var t,e,r,a,u;i(this),this.ui={btn:"#btn",result:".result",social:"ul.social",social_links:"ul.social a"},a=n(39),r={dictionary:o,base_path:s.base_path},$("body").append(a(r)),this.el=$("#end_screen"),u=this.ui;for(e in u)t=u[e],this.ui[e]=this.el.find(t);this.bind()}return t.prototype.bind=function(){return this.ui.btn.on("click",this.on_click),this.ui.social_links.on("click",this.share)},t.prototype.unbind=function(){return this.ui.btn.off("click",this.on_click),this.ui.social_links.off("click",this.share)},t.prototype.on_click=function(){return this.once("hidden",function(t){return function(){return t.reset(),t.emit("replay")}}(this)),this.hide()},t.prototype.show=function(){var t,e;return u.fade_in(),TweenLite.to(this.el,1,{autoAlpha:1}),this.ui.title_letters.each(function(t,e){var n,o,i;return n=l.random(.2,1.4),o=l.random(2,3),i={opacity:1,ease:Power3.easeIn,delay:n},TweenLite.to(e,o,i)}),t=1200,this.ui.message_letters.each(function(e,n){var o;return t+=60,o=l.random(500,600),$(n).delay(t).animate({opacity:1},o)}),e={autoAlpha:.75,delay:2.3,ease:Power1.easeOut},TweenLite.to(this.ui.btn,1,e)},t.prototype.hide=function(){var t;return u.fade_out(),t={autoAlpha:0,onComplete:function(t){return function(){return t.ui.result.removeClass("success failed"),t.emit("hidden")}}(this)},TweenLite.to(this.el,.5,t)},t.prototype.render_result=function(){var t,e,i;return e=r.game_completed(),i=n(22)("./"+e+".jade"),t={dictionary:o,base_path:s.base_path},this.ui.result.append(i(t)),this.ui.result.addClass(e),this.ui.title_letters=this.el.find(".title").lettering().children(),this.ui.message_letters=this.el.find(".message p").lettering().children()},t.prototype.share=function(t){var e,n,i;switch(t.preventDefault(),i=r.game_completed(),e=o.get("social_network_"+i),n=$(t.currentTarget).data("share")){case"facebook":return a.facebook(void 0,e);case"twitter":return a.twitter(void 0,e);case"google":return a.plus(void 0)}},t.prototype.reset=function(){return this.ui.result.html("")},t}())},function(t,e,n){var o,i,r,s,a,u,l,d=function(t,e){return function(){return t.apply(e,arguments)}};l=n(21),r=n(40),i=n(41),a=n(42),u=n(43),s=n(44),Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){var t,e;for(t=0,e=this.length;e>t;)this[t]&&this[t].parentElement&&this[t].parentElement.removeChild(this[t]),t++},t.exports=o=function(){function t(){this.error=d(this.error,this),this.success=d(this.success,this),l(this),this.manifest=[]}return t.prototype.add=function(t,e,n,o){var i;return i={id:t,src:e,type:n,data:o},this.manifest.push(i)},t.prototype.load=function(){var t,e,n,o,l,c;for(this.count=0,this.total=this.manifest.length,this.date=new Date,l=this.manifest,c=[],n=0,o=l.length;o>n;n++)switch(t=l[n],t.type){case"json":case"xml":e=new r,e.once("loaded",this.success),c.push(e.load(t));break;case"image":e=new a,e.once("loaded",this.success),c.push(e.load(t));break;case"binary":e=new i,e.once("loaded",this.success),c.push(e.load(t));break;case"js":e=new u,e.once("loaded",this.success),c.push(e.load(t));break;case"geometry":e=new s,e.once("loaded",this.success),c.push(e.load(t));break;default:c.push(void 0)}return c},t.prototype.dispose=function(){var t,e,n,o,i;for(o=this.manifest,i=[],e=0,n=o.length;n>e;e++)switch(t=o[e],t.type){case"js":i.push(document.getElementById(t.id).remove());break;default:i.push(void 0)}return i},t.prototype.success=function(){return this.count++,this.count>=this.total?this.emit("loaded",this.manifest):void 0},t.prototype.error=function(t){return c.log("error",t)},t.prototype.get_asset=function(t){var e,n,o,i,r;for(n=!1,r=this.manifest,o=0,i=r.length;i>o;o++)e=r[o],e.id===t&&(n=e);return n},t}()},function(t,e,n){var o,i,r,s,a,u,l,c,d,h,p,f,_,m,g,y,v,b,w,x,E,k,A,C=function(t,e){return function(){return t.apply(e,arguments)}};p=n(21),g=n(12),_=n(23),c=n(45),y=n(1),A=n(10),h=n(7),s=n(24),m=n(9),d=n(11).user,b=n(25),k=n(27),w=n(28),v=n(26),x=n(29),E=n(30),o=n(31),f=n(32),u=n(33),a=n(34),r=n(35),i=n(36),t.exports=l=function(){function t(){this.end=C(this.end,this),this.loaded=C(this.loaded,this),p(this),y.debug&&(window.game=this)}return t.prototype.is_loaded=!1,t.prototype.load=function(){var t,e,n,o;for(e=new s,e.once("done",this.loaded),n=0,o=c.length;o>n;n++)t=c[n],_.add(t.id,t.src,t.type);return e.listen(_,"loaded"),e.listen(b,"loaded"),e.listen(k,"loaded"),e.listen(x,"loaded"),e.listen(E,"loaded"),e.listen(w,"loaded"),e.listen(v,"loaded"),_.load(),k.load(),b.load(),x.load(),E.load(),w.load(),v.load()},t.prototype.loaded=function(){var t,e,n;for(e=0,n=f.length;n>e;e++)t=f[e],g.add(t);return this.camera_controller=new o,this.camera_controller.bind(),this.skull_rings=new u,this.clock=new i,this.is_loaded=!0,this.emit("loaded")},t.prototype.start=function(){var t;return this.reset(),k.once("ended",this.end),this.skull_rings.start(),k.play(),y.fog&&(t={density:.00325},TweenLite.to(g.fog,3,t)),m.emit("game:start")},t.prototype.reset=function(){return y.fog&&(g.fog.density=.1),m.reset(),this.skull_rings.reset(),k.stop(),b.fade_out(),v.stop(),m.once("game:over",this.end)},t.prototype.end=function(){return m.off("game:over",this.end),m.get("user_clicked")===!1&&m.set("success",!1),m.set("finished",!0),k.stop(),this.emit("ended"),delay(2e3,function(t){return function(){return t.reset()}}(this))},t}()},function(t){function e(t){if(!(t&&t instanceof Function))throw new Error(t+" is not a Function")}t.exports=function(t){t=t||{};for(var e in n)t[e]=n[e];return t};var n={__init:function(t){var e=this.__listeners||(this.__listeners=[]);return e[t]||(e[t]=[])},on:function(t,n){e(n),this.__init(t).push(n)},off:function(t,e){var n=this.__init(t);n.splice(n.indexOf(e),1)},once:function(t,n){e(n);var o=this,i=function(){o.off(t,i),n.apply(this,arguments)};this.on(t,i)},emit:function(t){var e,n=this.__init(t).slice(0);for(e in n)n[e].apply(this,[].slice.call(arguments,1))}}},function(t,e,n){function o(t){return n(i(t))}function i(t){return r[t]||function(){throw new Error("Cannot find module '"+t+"'.")}()}var r={"./failed.jade":47,"./success.jade":48};o.keys=function(){return Object.keys(r)},o.resolve=i,t.exports=o,o.id=22},function(t,e,n){var o;o=n(19),t.exports=new o},function(t,e,n){var o,i=function(t,e){return function(){return t.apply(e,arguments)}};o=n(21),t.exports=function(){function t(t){this.destroy_after=null!=t?t:!0,this.done=i(this.done,this),o(this),this.objects=[],this.events=[]}return t.prototype.objects=Array,t.prototype.events=Array,t.prototype.count=0,t.prototype.listen=function(t,e){return t.on(e,this.done),this.objects.push(t),this.events.push(e)},t.prototype.done=function(){var t,e,n,o,i;if(this.count++,this.count>=this.objects.length&&(this.emit("done"),this.count=0,this.destroy_after)){for(this.objects=[],o=this.objects,i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(t.off(this.done));return i}},t}()},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};o=n(21),i=n(1),t.exports=new(function(){function t(){this.stop=r(this.stop,this),this.pause=r(this.pause,this),this.play=r(this.play,this),o(this),window.sound_intro=this}return t.prototype.load=function(){return this.sound=new Howl({urls:["sound/intro_loop.mp3","sound/intro_loop.ogg","sound/intro_loop.wav"],onload:function(t){return function(){return t.emit("loaded")}}(this),loop:!0})},t.prototype.play=function(){return this.sound.play()},t.prototype.pause=function(){return this.sound.pause()},t.prototype.stop=function(){return this.sound.stop()},t.prototype.volume=function(t){return this.sound.volume(t)},t.prototype.fade_in=function(){return this.sound.volume(0),this.sound.fade(0,1,500)},t.prototype.fade_out=function(){return this.sound.fade(1,0,6e3,function(t){return function(){return t.stop()}}(this))},t}())},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};o=n(21),i=n(1),t.exports=new(function(){function t(){this.stop=r(this.stop,this),this.play=r(this.play,this),o(this),i.live||(window.sound_success=this)}return t.prototype.playing=!1,t.prototype.load=function(){return this.sound=new Howl({urls:["sound/game_end.mp3","sound/game_end.ogg","sound/game_end.wav"],onload:function(t){return function(){return t.emit("loaded")}}(this)})},t.prototype.play=function(){var t;return null!=(t=this.sound)?t.play():void 0},t.prototype.stop=function(){return this.sound.stop()},t.prototype.fade_in=function(){var t,e;return null!=(t=this.sound)&&t.volume(0),null!=(e=this.sound)&&e.fade(0,1,2e3),this.play()},t.prototype.fade_out=function(){return this.sound.fade(1,0,2e3,function(t){return function(){return t.stop()}}(this))},t}())},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};o=n(21),i=n(1),t.exports=new(function(){function t(){this.stop=r(this.stop,this),this.pause=r(this.pause,this),this.play=r(this.play,this),o(this),window.player=this}return t.prototype.playing=!1,t.prototype.load=function(){return this.sound=new Howl({urls:["sound/game_track.mp3"],onload:function(t){return function(){return t.emit("loaded")}}(this),onend:function(t){return function(){return t.on_ended()}}(this)})},t.prototype.on_ended=function(){return this.emit("ended")},t.prototype.play=function(){return this.playing=!0,this.emit("play"),this.sound.play()},t.prototype.pause=function(){return this.sound.pause()},t.prototype.stop=function(){var t;return this.playing=!1,null!=(t=this.sound)?t.stop():void 0},t.prototype.position=function(){return this.sound.pos()/this.sound._duration},t}())},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};o=n(21),i=n(1),t.exports=new(function(){function t(){this.stop=r(this.stop,this),this.play=r(this.play,this),o(this),i.live||(window.sound_krampus=this)}return t.prototype.playing=!1,t.prototype.load=function(){return this.sound=new Howl({urls:["sound/krampus.mp3","sound/krampus.ogg","sound/krampus.wav"],onload:function(t){return function(){return t.emit("loaded")}}(this)})},t.prototype.play=function(){return this.sound.play()},t.prototype.stop=function(){return this.sound.stop()},t}())},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};o=n(21),i=n(1),t.exports=new(function(){function t(){this.stop=r(this.stop,this),this.play=r(this.play,this),o(this),i.live||(window.sound_krampus=this)}return t.prototype.playing=!1,t.prototype.load=function(){return this.sound=new Howl({urls:["sound/skull_explode.mp3","sound/skull_explode.ogg","sound/skull_explode.wav"],onload:function(t){return function(){return t.emit("loaded")}}(this)})},t.prototype.play=function(){return this.sound.play()},t.prototype.stop=function(){return this.sound.stop()},t}())},function(t,e,n){var o,i,r=function(t,e){return function(){return t.apply(e,arguments)}};o=n(21),i=n(1),t.exports=new(function(){function t(){this.stop=r(this.stop,this),this.play=r(this.play,this),o(this),i.live||(window.sound_krampus=this)}return t.prototype.playing=!1,t.prototype.load=function(){return this.sound=new Howl({urls:["sound/skull_jaw.mp3","sound/skull_jaw.ogg","sound/skull_jaw.wav"],onload:function(t){return function(){return t.emit("loaded")}}(this)})},t.prototype.play=function(){return this.sound.play()},t.prototype.stop=function(){return this.sound.stop()},t}())},function(t,e,n){var o,i,r,s,a,u,l,c=function(t,e){return function(){return t.apply(e,arguments)}};r=n(7),a=n(12),l=n(10),o=n(49),i=n(11).user,u=n(1),s=n(9),t.exports=function(){function t(){this.on_mouse_move=c(this.on_mouse_move,this);var t,e;this.mouse=new o($(window)),t=300,e=.5*t,this.min=new THREE.Vector2(-e,-e),this.max=new THREE.Vector2(e,e),this.bounds=new THREE.Box2(this.min,this.max),u.debug&&(a.add(new THREE.CameraHelper(i)),this.bounds_helper=new THREE.Mesh(new THREE.PlaneGeometry(t,t,1,1),new THREE.MeshBasicMaterial({color:16711680,wireframe:!0})),a.add(this.bounds_helper))}return t.prototype.enabled=!1,t.prototype.bind=function(){return this.mouse.on("move",this.on_mouse_move),this.mouse.bind(),s.on("game:start",function(t){return function(){return t.enabled=!0}}(this)),s.on("success",function(t){return function(){var e;return null!=(e=t.tween)&&e.kill(),t.enabled=!1}}(this))},t.prototype.on_mouse_move=function(){var t,e,n,o;return null!=(o=this.tween)&&o.kill(),e=l.lerp(this.min.x,this.max.x,this.mouse.normal_x),n=l.lerp(this.min.y,this.max.y,this.mouse.normal_y),t={x:e,y:-n,ease:Power1.easeOut},this.tween=TweenLite.to(i.position,2,t)},t}()},function(t){var e,n;n=new THREE.AmbientLight(4210752),e=new THREE.DirectionalLight(16777215,1),e.position.set(0,1,.5),e.castShadow=!0,t.exports=[n,e]},function(t,e,n){var o,i,r,s,a,u,l,c=function(t,e){return function(){return t.apply(e,arguments)}};o=n(24),l=n(10),r=n(50),a=n(12),i=n(16),s=n(9),u=n(1),t.exports=function(){function t(){this.update=c(this.update,this),this.sort_skull_rings=c(this.sort_skull_rings,this);var t,e,n,o,s,l,d;for(this.skull_rings=[],o=u.live?2:0,e=l=0,d=this.num_skull_rings;d>=0?d>l:l>d;e=d>=0?++l:--l)n=e===o?!0:!1,t={index:e,krampus:n},s=new r(t),a.add(s.container),this.skull_rings.push(s);i.on("tick",this.update)}return t.prototype.num_skull_rings=3,t.prototype.show_krampus=!1,t.prototype.loop_count=null,t.prototype.start=function(){var t,e,n,i,r;for(this.finshed=!1,this.loop_count=0,this.skull_ring_promise=new o(!1),this.skull_ring_promise.on("done",this.sort_skull_rings),i=this.skull_rings,r=[],e=0,n=i.length;n>e;e++)t=i[e],this.skull_ring_promise.listen(t,"complete"),r.push(t.animate());return r},t.prototype.sort_skull_rings=function(){var t,e,n,o,i,r,s,a,u,l,c,d,h,p,f,_,m,g,y;for(o=[],_=this.skull_rings,e=a=0,d=_.length;d>a;e=++a)r=_[e],t=r.container.position.z,t>0&&o.push(e);for(u=0,h=o.length;h>u;u++){for(n=o[u],i=null,s=0,m=this.skull_rings,e=l=0,p=m.length;p>l;e=++l)r=m[e],s>=t&&(s=t,i=e);this.skull_rings[n].reset_from(s)}for(g=this.skull_rings,y=[],e=c=0,f=g.length;f>c;e=++c)r=g[e],y.push(r.animate());return y},t.prototype.update=function(){var t,e,n,o,i;for(o=this.skull_rings,i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(t.update());return i},t.prototype.reset=function(){var t,e,n,o,i,r,s;for(null!=(i=this.skull_ring_promise)&&i.off("done",this.sort_skull_rings),r=this.skull_rings,s=[],t=n=0,o=r.length;o>n;t=++n)e=r[t],s.push(e.reset());return s},t}()},function(t,e,n){var o,i,r,s,a,u,l,d,h,p,f,_,m,g=function(t,e){return function(){return t.apply(e,arguments)}};a=n(21),m=n(10),s=n(7),u=n(23),r=n(11),h=n(1),o=n(51),l=n(9),d=n(12),p=n(28),f=n(29),_=n(30),t.exports=i=function(){function t(t,e){var o,i,r,s,l,c,d,h;this.parent=e,this.on_mouse_click=g(this.on_mouse_click,this),this.on_mouse_move=g(this.on_mouse_move,this),this.mode_random_rotate=g(this.mode_random_rotate,this),a(this),this.config={krampus:!1,scale:5},m.merge(this.config,t),d=n(52),this.material=new THREE.MeshBasicMaterial({color:13421772,envMap:d.SkullEnv,transparent:!0,blending:2,opacity:.6}),this.krampus_horns_material=new THREE.MeshPhongMaterial({color:16715535,ambient:15437571}),this.krampus_material=new THREE.MeshPhongMaterial({color:9998737,ambient:0}),i=u.get_asset("skull_head").data.clone(),c=u.get_asset("skull_jaw").data.clone(),this.container=new THREE.Object3D,this.head=new THREE.Mesh(i,this.material),this.jaw=new THREE.Mesh(c,this.material),this.container.add(this.head),this.container.add(this.jaw),this.create_hotspot(),this.create_hover(),this.create_particles(),this.create_present(),this.config.krampus&&(o=100,r=u.get_asset("skull_horns").data.clone(),h=u.get_asset("skull_tongue").data.clone(),this.horns=new THREE.Mesh(r,this.krampus_horns_material),this.tongue=new THREE.Mesh(h,this.krampus_horns_material),this.horns.visible=!1,this.tongue.visible=!1,this.container.add(this.horns),this.container.add(this.tongue),s=new THREE.PointLight(16711680,2,50),s.position.set(0,0,5),this.container.add(s),l=new THREE.PointLight(15459075,2,30),l.position.set(0,0,4),this.container.add(l)),this.container.scale.set(this.config.scale,this.config.scale,this.config.scale),this.modes=["mode_jaw_hide","mode_explode","mode_explode"],this.config.krampus&&(this.modes=["mode_krampus"]),window.skull=this
}return t.prototype.current_mode="",t.prototype.over=!1,t.prototype.mouse_x=0,t.prototype.mouse_y=0,t.prototype.enabled=!0,t.prototype.debug=!1,t.prototype.default_position=null,t.prototype.bind=function(){return $(window).on("click",this.on_mouse_click),$(window).on("mousemove",this.on_mouse_move)},t.prototype.unbind=function(){return $(window).off("click",this.on_mouse_click),$(window).off("mousemove",this.on_mouse_move)},t.prototype.create_present=function(){var t,e,n,o;return o=.3,this.present=new THREE.Object3D,this.present.visible=!1,this.present.scale.set(o,o,o),this.present.rotation.set(Math.random(),Math.random(),Math.random()),this.container.add(this.present),t=u.get_asset("present_ribbon").data.clone(),n={color:16711680,side:THREE.DoubleSide},e=new THREE.MeshLambertMaterial(n),this.present_ribbon=new THREE.Mesh(t,e),this.present_ribbon.receiveShadow=!0,this.present_ribbon.castShadow=!0,this.present.add(this.present_ribbon),t=u.get_asset("present_box").data.clone(),n={color:16777215},e=new THREE.MeshBasicMaterial(n),o=.95,this.present_box=new THREE.Mesh(t,e),this.present_box.scale.set(o,o,o),this.present.add(this.present_box)},t.prototype.create_hotspot=function(){var t,e,n;return t=new THREE.SphereGeometry(8,8,8),n={color:65280,wireframe:!0,wireframeLinewidth:5},e=new THREE.MeshBasicMaterial(n),this.hotspot=new THREE.Mesh(t,e),this.hotspot.visible=this.debug,this.container.add(this.hotspot)},t.prototype.create_hover=function(){var t,e,n;return t=new THREE.RingGeometry(13,13.3,60),n={color:16777215,side:THREE.DoubleSide},e=new THREE.MeshBasicMaterial(n),this.hover_mesh=new THREE.Mesh(t,e),this.container.add(this.hover_mesh)},t.prototype.create_particles=function(){var t;return t={scale:1,points:u.get_asset("skull_head_points").data.positions},this.head_particles=new o(t,this.container),this.container.add(this.head_particles.mesh),t={scale:1,points:u.get_asset("skull_jaw_points").data.positions},this.jaw_particles=new o(t,this.container),this.jaw.add(this.jaw_particles.mesh)},t.prototype.disable=function(){return this.enabled?(this.unbind(),this.enabled=!1,this.hover_mesh.visible=!1,this.container.rotation.set(0,0,0),this.mode_krampus_on?void 0:(this.mode_random_rotate_on=!0,this.mode_random_rotate())):void 0},t.prototype.mode_random_rotate=function(){var t;return t=function(t){return function(){return t.container.rotation.y+=m.random(HALF_PI/8,HALF_PI/7)}}(this),this.interval_tween=setInterval(t,100)},t.prototype.reset_mode=function(){var t;return TweenLite.killTweensOf(this.container.rotation),null!=(t=this.tween_jaw)&&t.kill(),clearInterval(this.interval_tween),clearInterval(this.present_tween),this.mode_lookat_on=!1,this.mode_explode_on=!1,this.mode_krampus_on=!1,this.mode_random_rotate_on=!1,this.container.position.set(0,0,0),this.container.position.copy(this.default_position),this.container.rotation.set(0,0,0),this.jaw.rotation.set(0,0,0),this.material.opacity=1,this.config.krampus&&(this.horns.visible=!1,this.tongue.visible=!1,this.head.material=this.material,this.jaw.material=this.material),this.head.visible=!0,this.jaw.visible=!0,this.head_particles.mesh.visible=!0,this.jaw_particles.mesh.visible=!0,this.present.visible=!1,this.hover_mesh.visible=!1,this.head_particles.reset(),this.jaw_particles.reset(),this.enabled=!0,this.bind()},t.prototype.change_mode=function(){var t;return t=m.random_array_item(this.modes),this.current_mode=t,"mode_krampus"===this.current_mode&&(c.debug("USER FOUND, end game"),this.mode_krampus_found()),this[this.current_mode]()},t.prototype.mode_jaw_move=function(){var t;return t={x:m.random(HALF_PI/4,HALF_PI),repeat:-1,yoyo:!0,ease:Power1.easeIn,repeatDelay:m.random(.7,.9)},this.tween_jaw=TweenLite.to(this.jaw.rotation,.05,t)},t.prototype.mode_jaw_hide=function(){return _.play(),this.jaw.visible=!1},t.prototype.mode_lookat=function(){return this.mode_lookat_on=!0},t.prototype.mode_krampus=function(){var t;return this.mode_lookat(),this.mode_krampus_on=!0,this.horns.visible=!0,this.tongue.visible=!0,this.head.material=this.krampus_material,this.jaw.material=this.krampus_material,this.head_particles.mesh.visible=!1,this.jaw_particles.mesh.visible=!1,t={x:.14},this.tween_tongue=TweenLite.to(this.tongue.rotation,.1,t),t={x:.51},this.tween_jaw=TweenLite.to(this.jaw.rotation,.1,t)},t.prototype.mode_krampus_found=function(){var t;return c.log("xxxxxxxxxxx"),p.play(),l.set("success",!1),t={x:this.camera_position.x,y:this.camera_position.y,z:this.camera_position.z-100,onComplete:function(){return function(){return l.emit("game:over")}}(this)},TweenLite.to(this.container.position,1,t),h.fog?(t={density:.1,delay:.7,onComplete:function(t){return function(){return t.container.position.copy(t.default_position)}}(this)},TweenLite.to(d.fog,2,t)):void 0},t.prototype.mode_explode=function(){var t,e,n,o,i;return f.play(),this.mode_explode_on=!0,e=[["0xffffff","0xff0000"]],t=m.random_array_item(e),this.present_box.material.color.setHex(t[0]),this.present_ribbon.material.color.setHex(t[1]),i=.05,this.present.scale.set(i,i,i),this.present.visible=!0,o={x:.9,y:.9,z:.9,ease:Elastic.easeOut},TweenLite.to(this.present.scale,1,o),n=function(t){return function(){return t.present.rotation.x+=m.random(HALF_PI/8,HALF_PI/7),t.present.rotation.z+=m.random(HALF_PI/8,HALF_PI/7)}}(this),this.present_tween=setInterval(n,150),this.head.visible=!1,this.jaw.visible=!1,this.head_particles.explode(),this.jaw_particles.explode()},t.prototype.update=function(t){var e,n,o,i,s,a,u;return this.camera_position=t,this.mode_lookat_on&&this.container.lookAt(this.camera_position),this.hover_mesh.visible=this.enabled&&this.parent.position.z>=-499?!0:!1,this.enabled?(e=h.debug?r.dev:r.user,o=this.mouse_x/window.innerWidth*2-1,i=2*-(this.mouse_y/window.innerHeight)+1,u=new THREE.Vector3(o,i,.5),s=new THREE.Projector,s.unprojectVector(u,e),a=new THREE.Raycaster(e.position,u.sub(e.position).normalize()),a.far=500,n=a.intersectObject(this.hotspot),n.length>0?this.on_over():this.on_out()):void 0},t.prototype.on_mouse_move=function(t){return this.mouse_x=t.clientX,this.mouse_y=t.clientY},t.prototype.on_over=function(){return this.enabled&&!this.over?($("body").css("cursor","pointer"),this.over=!0,this.hover_mesh.material.color.setHex("0xff0000")):void 0},t.prototype.on_out=function(){return this.enabled&&this.over?(this.over=!1,$("body").css("cursor",""),this.hover_mesh.material.color.setHex("0xFFFFFF")):void 0},t.prototype.on_mouse_click=function(){return this.over&&this.enabled?(this.enabled=!1,$("body").css("cursor",""),this.change_mode(),this.unbind(),l.set("user_clicked",!0),this.emit("click")):void 0},t.prototype.cache_random_positions=function(t,e,n){var o,i,r,s,a;for(null==n&&(n=1e4),o={positions:[]},i=a=0;n>=0?n>a:a>n;i=n>=0?++a:--a)s=THREE.GeometryUtils.randomPointsInGeometry(t.geometry,1)[0],o.positions.push(s.toArray());return r=JSON.stringify(o),$.ajax({type:"POST",url:"cache_positions.php",dataType:"json",data:{path:e,json:r},success:function(){return function(t){return console.info(t.status)}}(this),error:function(){return function(t){return console.error(t.status)}}(this)})},t}()},function(t){var e;t.exports=e=function(){function t(){var t,e,n;this.container=new THREE.Object3D,n={color:0},e=new THREE.MeshPhongMaterial(n),t=new THREE.IcosahedronGeometry(50,1),this.mesh=new THREE.Mesh(t,e),this.container.add(this.mesh)}return t}()},function(t,e,n){var o,i,r,s,a,u,l=function(t,e){return function(){return t.apply(e,arguments)}};s=n(12),a=n(27),o=n(16),u=n(10),r=n(23),i=n(7),t.exports=function(){function t(){this.reset_clock=l(this.reset_clock,this),this.update=l(this.update,this);var t,e;c.log("xxxxx"),this.container=new THREE.Object3D,this.container.position.set(0,0,-200),this.container.rotation.set(-.51,.18,-.09),s.add(this.container),this.create_numbers(),this.create_minute_hand(),this.create_hour_hand(),this.reset_clock(),t=500,e=i.addFolder("clock"),e.add(this.container.position,"x",-t,t),e.add(this.container.position,"y",-t,t),e.add(this.container.position,"z",-t,t),e.add(this.container.rotation,"x",-PI,PI),e.add(this.container.rotation,"y",-PI,PI),e.add(this.container.rotation,"z",-PI,PI),this.bind()}return t.prototype.time=0,t.prototype.bind=function(){return o.on("tick",this.update),a.on("play",this.reset_clock)},t.prototype.update=function(){return a.playing?(this.time=u.lerp(this.date.getTime(),this.end_date.getTime(),a.position()),this.update_clock()):void 0},t.prototype.reset_clock=function(){return this.date=new Date,this.date.setHours(0,0,0),this.end_date=new Date,this.end_date.setHours(24,0,0)},t.prototype.update_clock=function(){var t,e,n;return t=new Date,t.setTime(this.time),e=t.getHours()/2/11,this.hour_hand.rotation.z=-TWO_PI*e,n=t.getMinutes()/60,this.minute_hand.rotation.z=-TWO_PI*n},t.prototype.create_numbers=function(){var t,e,n,o,i,r,s,a,u,l,c,d,h,p,f,_,m;for(r=[3,4,5,6,7,8,9,10,11,12,1,2],l=45,u={size:3,height:.5,curveSegments:2,font:"princess sofia"},n=new THREE.MeshBasicMaterial({color:16711680}),m=[],e=f=0,_=r.length;_>f;e=++f)i=r[e],c=e*(TWO_PI/r.length),d=l*Math.cos(-c),h=l*Math.sin(-c),p=0,t=new THREE.TextGeometry(i,u),t.computeBoundingBox(),o=new THREE.Mesh(t,n),o.position.set(d,h,p),s=-.5*(t.boundingBox.max.x-t.boundingBox.min.x),a=-.5*(t.boundingBox.max.y-t.boundingBox.min.y),o.x+=s,o.y+=a,m.push(this.container.add(o));return m},t.prototype.create_minute_hand=function(){var t,e,n,o,i;return i=12,t=r.get_asset("clock_minute").data.clone(),o={side:THREE.DoubleSide,color:16777215},e=new THREE.MeshBasicMaterial(o),n=new THREE.Mesh(t,e),n.scale.set(i,i,i),this.minute_hand=new THREE.Object3D,this.minute_hand.add(n),this.container.add(this.minute_hand)},t.prototype.create_hour_hand=function(){var t,e,n,o,i;return i=12,t=r.get_asset("clock_hour").data.clone(),o={side:THREE.DoubleSide,color:16777215},e=new THREE.MeshBasicMaterial(o),n=new THREE.Mesh(t,e),n.scale.set(i,i,i),this.hour_hand=new THREE.Object3D,this.hour_hand.add(n),this.container.add(this.hour_hand)},t}()},function(t,e,n){var o=n(53);t.exports=function(t){var e,n=[],i=t||{};return function(t){n.push('<div id="unsupported_screen" class="layer layer_1 overlay"><div class="content layer"><h1 class="title">'+o.escape(null==(e=t.get("title"))?"":e)+'</h1><div class="intro"> <p>'+(null==(e=t.get("unsupported_screen_intro_0"))?"":e)+"</p><p>"+(null==(e=t.get("unsupported_screen_intro_1"))?"":e)+"</p><p>"+(null==(e=t.get("unsupported_screen_intro_2"))?"":e)+"</p></div></div></div>")}.call(this,"dictionary"in i?i.dictionary:"undefined"!=typeof dictionary?dictionary:void 0),n.join("")}},function(t,e,n){var o=n(53);t.exports=function(t){var e,n=[],i=t||{};return function(t){n.push('<div id="start_screen" class="layer layer_1 overlay"><div class="content layer"><h1 class="title">'+o.escape(null==(e=t.get("title"))?"":e)+'</h1><div class="intro"> <p>'+(null==(e=t.get("start_screen_intro_0"))?"":e)+"</p><p>"+(null==(e=t.get("start_screen_intro_1"))?"":e)+"</p><p>"+(null==(e=t.get("start_screen_intro_2"))?"":e)+"</p><p>"+(null==(e=t.get("start_screen_intro_3"))?"":e)+'</p></div><div id="loading">'+o.escape(null==(e=t.get("start_screen_loading"))?"":e)+'</div><a id="btn" href="#" class="btn">'+o.escape(null==(e=t.get("start_screen_btn"))?"":e)+"</a></div></div>")}.call(this,"dictionary"in i?i.dictionary:"undefined"!=typeof dictionary?dictionary:void 0),n.join("")}},function(t,e,n){var o=n(53);t.exports=function(t){var e,n=[],i=t||{};return function(t){n.push('<div id="end_screen" class="layer layer_1 overlay"><div class="content layer"><div class="result"></div><br/><a id="btn" href="#" class="btn">'+o.escape(null==(e=t.get("end_screen_btn"))?"":e)+"</a></div></div>")}.call(this,"dictionary"in i?i.dictionary:"undefined"!=typeof dictionary?dictionary:void 0),n.join("")}},function(t,e,n){var o,i;i=n(21),t.exports=o=function(){function t(){i(this)}return t.prototype.load=function(t){return $.ajax({url:t.src,dataType:t.type,success:function(e){return function(n){return t.data=n,e.emit("loaded",t)}}(this),error:function(){return function(t){return c.error("error",t)}}(this)})},t}()},function(t,e,n){var o,i;i=n(21),t.exports=o=function(){function t(){i(this)}return t.prototype.load=function(t){var e,n;if(n=this.req(),!e){e="arraybuffer";try{Blob.prototype.slice&&(e="blob")}catch(o){}}return n.open("GET",t.src,!0),n.responseType=e,n.onprogress=function(){},n.onreadystatechange=function(e){return function(){4===n.readyState&&(t.data=n.response,e.emit("loaded",t),n.onreadystatechange=null)}}(this),n.send(null)},t.prototype.req=function(){return window.XMLHttpRequest?new XMLHttpRequest:window.ActiveXObject?new ActiveXObject("MSXML2.XMLHTTP.3.0"):void 0},t}()},function(t,e,n){var o,i;i=n(21),t.exports=o=function(){function t(){i(this)}return t.prototype.load=function(t){var e;return e=new Image,e.onload=function(n){return function(){return t.data=e,n.emit("loaded",t)}}(this),e.src=t.src},t}()},function(t,e,n){var o,i;i=n(21),t.exports=o=function(){function t(){i(this)}return t.prototype.load=function(t){var e;return e=document.createElement("script"),e.setAttribute("type","text/javascript"),e.setAttribute("src",t.src),e.setAttribute("id",t.id),document.getElementsByTagName("head")[0].appendChild(e),this.emit("loaded",t)},t}()},function(t,e,n){var o,i;i=n(21),t.exports=o=function(){function t(){i(this)}return t.prototype.load=function(t){var e;return e=new THREE.JSONLoader,e.load(t.src,function(e){return function(n){return t.data=n,e.emit("loaded",t)}}(this))},t}()},function(t,e,n){var o,i,r,s,a;for(r=n(1),i=[{id:"skull_head",src:"obj/skull_head.js",type:"geometry"},{id:"skull_jaw",src:"obj/skull_jaw.js",type:"geometry"},{id:"skull_horns",src:"obj/skull_horns.js",type:"geometry"},{id:"skull_tongue",src:"obj/skull_tongue.js",type:"geometry"},{id:"clock_hour",src:"obj/clock_hour.js",type:"geometry"},{id:"clock_minute",src:"obj/clock_minute.js",type:"geometry"},{id:"present_box",src:"obj/present_box.js",type:"geometry"},{id:"present_ribbon",src:"obj/present_ribbon.js",type:"geometry"},{id:"skull_head_points",src:"data/skull_head_points.json",type:"json"},{id:"skull_jaw_points",src:"data/skull_jaw_points.json",type:"json"},{id:"skull_horns_points",src:"data/skull_horns_points.json",type:"json"},{id:"skull_tongue_points",src:"data/skull_tongue_points.json",type:"json"},{id:"particle_mat",src:"img/textures/particle_mat.jpg",type:"image"},{id:"skull_env",src:"img/textures/skull_env.jpg",type:"image"}],s=0,a=i.length;a>s;s++)o=i[s],o.src=r.base_path+o.src;t.exports=i},function(t,e,n){t.exports=n(54),t.exports.color=n(55)},function(t,e,n){var o=n(53);t.exports=function(t){var e,n=[],i=t||{};return function(i){n.push('<h1 class="title">'+o.escape(null==(e=i.get("fail_title"))?"":e)+'</h1><p class="message">'+o.escape(null==(e=i.get(""))?"":e)+'</p><div class="message"> <p>'+(null==(e=i.get("fail_text_0"))?"":e)+"</p><p>"+(null==(e=i.get("fail_text_1"))?"":e)+"</p></div><img"+o.attr("src",""+t.base_path+"img/krampus.jpg",!0,!1)+"/>")}.call(this,"dictionary"in i?i.dictionary:"undefined"!=typeof dictionary?dictionary:void 0),n.join("")}},function(t,e,n){var o=n(53);t.exports=function(t){var e,n=[],i=t||{};return function(i){n.push('<h1 class="title">'+o.escape(null==(e=i.get("success_title"))?"":e)+'</h1><div class="message"> <p>'+(null==(e=i.get("success_text_0"))?"":e)+"</p><p>"+(null==(e=i.get("success_text_1"))?"":e)+"</p></div><img"+o.attr("src",""+t.base_path+"img/krampus.jpg",!0,!1)+"/>")}.call(this,"dictionary"in i?i.dictionary:"undefined"!=typeof dictionary?dictionary:void 0),n.join("")}},function(t,e,n){var o,i,r,s=function(t,e){return function(){return t.apply(e,arguments)}};i=n(21),r=n(15),t.exports=o=function(){function t(t){this.el=t,this.mouseup=s(this.mouseup,this),this.mousedown=s(this.mousedown,this),this.mousemove=s(this.mousemove,this),i(this)}return t.prototype.mouse_x=0,t.prototype.mouse_y=0,t.prototype.mouse_last_x=0,t.prototype.mouse_last_y=0,t.prototype.normal_x=0,t.prototype.normal_y=0,t.prototype.normal_center_x=0,t.prototype.normal_center_y=0,t.prototype.clicked_x=0,t.prototype.clicked_y=0,t.prototype.bind=function(){return this.el.on("mousedown",this.mousedown),this.el.on("mouseup",this.mouseup),this.el.on("mousemove",this.mousemove)},t.prototype.unbind=function(){return this.el.off("mousedown",this.mousedown),this.el.off("mouseup",this.mouseup),this.el.off("click",this.click)},t.prototype.mousemove=function(t){var e;return this.mouse_last_x=this.mouse_x,this.mouse_last_y=this.mouse_y,e=this._get_event_position(t),this.mouse_x=e.x,this.mouse_y=e.y,this.normal_x=this.mouse_x/r.width,this.normal_y=this.mouse_y/r.height,this.normal_center_x=-.5+this.normal_x,this.normal_center_y=-.5+this.normal_y,this.emit("move")},t.prototype.mousedown=function(t){var e;return e=this._get_event_position(t),this.clicked_x=e.x,this.clicked_y=e.y,this.emit("down",e)},t.prototype.mouseup=function(){return this.emit("up")},t.prototype._get_event_position=function(t){var e,n;return e=t.pageX,n=t.pageY,{x:e,y:n}},t}()},function(t,e,n){var o,i,r,s,a,u,l,c,d=function(t,e){return function(){return t.apply(e,arguments)}};r=n(21),u=n(12),c=n(10),s=n(23),o=n(34),i=n(11).user,a=n(9),l=n(1),t.exports=function(){function t(t){this.disable_other_skulls=d(this.disable_other_skulls,this);var n,i,s,a,u,h,p,f,_,m,g,y,v,b,w,x,E,k,A,C,T,R,S;for(r(this),this.config={krampus:!1,offset:-200,index:0,points:3,radius:100},c.merge(this.config,t),this.krampus_index=null,this.container=new THREE.Object3D,this.points=[],a=new THREE.Geometry,n=e/this.config.points,u=x=0,T=this.config.points;T>=0?T>=x:x>=T;u=T>=0?++x:--x)i=this.config.index%2===0?0:HALF_PI,y=i+u*n,v=this.config.radius*Math.cos(y),b=this.config.radius*Math.sin(y),w=0,this.points.push(new THREE.Vector3(v,b,w));for(R=this.points,E=0,A=R.length;A>E;E++)m=R[E],a.vertices.push(m.clone());for(_={color:16777215,linewidth:1},this.shape=new THREE.Line(a,new THREE.LineBasicMaterial(_)),this.container.add(this.shape),this.skulls=[],this.config.krampus&&(s=[0,1,2],p=l.live?c.random_array_item(s):0),S=this.points,u=k=0,C=S.length;C>k;u=++k)f=S[u],3!==u&&(this.config.krampus&&(h=u===p?!0:!1),g=new o({scale:5,krampus:h},this.container),g.on("click",this.disable_other_skulls),this.container.add(g.container),g.container.position.copy(f),g.default_position=g.container.position.clone(),this.skulls.push(g));this.reset()}var e;return e=2*Math.PI,t.prototype.animate=function(){var t,e,n;if(!a.finished)return null!=(n=this.tween)&&n.kill(),e=this.container.position.z+50,t={z:e,ease:Power1.easeIn,delay:.5,onComplete:function(t){return function(){return t.emit("complete")}}(this)},this.tween=TweenLite.to(this.container.position,.45,t)},t.prototype.disable_other_skulls=function(){var t,e,n,o,i;for(o=this.skulls,i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(t.disable());return i},t.prototype.update=function(){var t,e,n,o,r,s,a;for(e=i.position.clone(),e.z-=this.container.position.z,t=!1,s=this.skulls,a=[],o=0,r=s.length;r>o;o++)n=s[o],a.push(n.update(e,t));return a},t.prototype.reset=function(){var t,e,n,o,i,r;for(null!=(o=this.tween)&&o.kill(),TweenLite.killTweensOf(this.container.position),this.container.position.z=-300+(this.config.index+1)*this.config.offset,i=this.skulls,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(t.reset_mode());return r},t.prototype.reset_from=function(t){var e,n,o,i,r;for(this.container.position.z=t+(this.config.index+1)*this.config.offset,i=this.skulls,r=[],n=0,o=i.length;o>n;n++)e=i[n],r.push(e.reset_mode());return r},t}()},function(t,e,n){var o,i,r,s,a,u,l;l=n(10),r=n(1),s=n(7),a=n(23),u=n(12),i=n(16),t.exports=o=function(){function t(t,e){var o,i,s,a,c,d,h,p,f,_,m,g,y,v;for(null==t&&(t={}),i={size_min:2,size_max:7,points:[],scale:1},l.merge(i,t),d=n(52),this.attributes={size:{type:"f",value:[]},alpha:{type:"f",value:[]}},_={color:{type:"c",value:new THREE.Color(16777215)},texture:{type:"t",value:d.ParticlesMap}},this.fog_enabled&&r.fog&&(_.topColor={type:"c",value:new THREE.Color(30719)},_.bottomColor={type:"c",value:new THREE.Color(16777215)},_.offset={type:"f",value:33},_.exponent={type:"f",value:.6},_.fogColor={type:"c",value:u.fog.color},_.fogNear={type:"f",value:u.fog.near},_.fogFar={type:"f",value:u.fog.far},_.fogDensity={type:"f",value:u.fog.density}),c=new THREE.ShaderMaterial({uniforms:_,attributes:this.attributes,vertexShader:this.vertex(),fragmentShader:this.fragment(),blending:THREE.AdditiveBlending,transparent:!0,fog:this.fog_enabled}),o=50,this.positions=[],this.vectors=[],s=new THREE.Geometry,v=i.points,a=g=0,y=v.length;y>g;a=++g)p=v[a],h=(new THREE.Vector3).fromArray(p),h.multiplyScalar(i.scale),h.add(e.position),this.positions.push(h),s.vertices.push(new THREE.Vector3(h.x,h.y,h.z)),this.attributes.alpha.value[a]=1,this.attributes.size.value[a]=l.random(i.size_min,i.size_max),f=l.random(10,40),m=l.random_sphere_point(e.position.x,e.position.y,e.position.z,f),this.vectors.push(m);this.mesh=new THREE.PointCloud(s,c)}return t.prototype.iteration=1,t.prototype.enabled=!0,t.prototype.debug=!0,t.prototype.fog_enabled=!0,t.prototype.reset=function(){var t,e,n,o,i,r;for(r=this.mesh.geometry.vertices,t=o=0,i=r.length;i>o;t=++o)n=r[t],e=this.positions[t],n.x=e.x,n.y=e.y,n.z=e.z;return this.mesh.geometry.verticesNeedUpdate=!0},t.prototype.explode=function(){var t,e;return t=l.random(.4,.7),TweenLite.killTweensOf(this.tween),this.tween={progress:0},e={progress:1,ease:Power3.easeOut,onUpdate:function(t){return function(){var e,n,o,i,r,s,a;for(a=t.mesh.geometry.vertices,e=r=0,s=a.length;s>r;e=++r)o=a[e],n=t.positions[e],i=t.vectors[e],o.x=l.lerp(n.x,i[0],t.tween.progress),o.y=l.lerp(n.y,i[1],t.tween.progress),o.z=l.lerp(n.z,i[2],t.tween.progress);return t.mesh.geometry.verticesNeedUpdate=!0}}(this),onComplete:function(){return function(){}}(this)},TweenLite.to(this.tween,t,e)},t.prototype.vertex=function(){var t;return t=["attribute float alpha;","attribute float size;","varying float vAlpha;","void main() {","vAlpha = alpha;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = size * ( 100.0 / length( mvPosition.xyz ) );","gl_Position = projectionMatrix * mvPosition;","}"],t.join("\n")},t.prototype.fragment=function(){var t;return t=["uniform vec3 color;","varying float vAlpha;","uniform sampler2D texture;",THREE.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( color, vAlpha );","gl_FragColor = gl_FragColor * texture2D( texture, gl_PointCoord );",THREE.ShaderChunk.fog_fragment,"}"],t.join("\n")},t}()},function(t,e,n){var o;o=n(23),e.ParticlesMap=new function(){return THREE.ImageUtils.loadTexture(o.get_asset("particle_mat").src)},e.SkullEnv=new function(){var t,e,n,i;for(n=[],e=i=0;6>i;e=++i)n.push(o.get_asset("skull_env").src);return t=THREE.ImageUtils.loadTextureCube(n),t.format=THREE.RGBFormat,t}},function(t,e,n){"use strict";function o(t){return null!=t&&""!==t}function i(t){return Array.isArray(t)?t.map(i).filter(o).join(" "):t}e.merge=function r(t,e){if(1===arguments.length){for(var n=t[0],i=1;i<t.length;i++)n=r(n,t[i]);return n}var s=t["class"],a=e["class"];(s||a)&&(s=s||[],a=a||[],Array.isArray(s)||(s=[s]),Array.isArray(a)||(a=[a]),t["class"]=s.concat(a).filter(o));for(var u in e)"class"!=u&&(t[u]=e[u]);return t},e.joinClasses=i,e.cls=function(t,n){for(var o=[],r=0;r<t.length;r++)o.push(n&&n[r]?e.escape(i([t[r]])):i(t[r]));var s=i(o);return s.length?' class="'+s+'"':""},e.attr=function(t,n,o,i){return"boolean"==typeof n||null==n?n?" "+(i?t:t+'="'+t+'"'):"":0==t.indexOf("data")&&"string"!=typeof n?" "+t+"='"+JSON.stringify(n).replace(/'/g,"&apos;")+"'":o?" "+t+'="'+e.escape(n)+'"':" "+t+'="'+n+'"'},e.attrs=function(t,n){var o=[],r=Object.keys(t);if(r.length)for(var s=0;s<r.length;++s){var a=r[s],u=t[a];"class"==a?(u=i(u))&&o.push(" "+a+'="'+u+'"'):o.push(e.attr(a,u,!1,n))}return o.join("")},e.escape=function(t){var e=String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return e===""+t?t:e},e.rethrow=function s(t,e,o,i){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&e||i))throw t.message+=" on line "+o,t;try{i=i||n(56).readFileSync(e,"utf8")}catch(r){s(t,null,o)}var a=3,u=i.split("\n"),l=Math.max(o-a,0),c=Math.min(u.length,o+a),a=u.slice(l,c).map(function(t,e){var n=e+l+1;return(n==o?"  > ":"    ")+n+"| "+t}).join("\n");throw t.path=e,t.message=(e||"Jade")+":"+o+"\n"+a+"\n\n"+t.message,t}},function(t){var e=t.exports=e||{};e.gui=e.gui||{},e.utils=e.utils||{},e.controllers=e.controllers||{},e.dom=e.dom||{},e.color=e.color||{},e.utils.css=function(){return{load:function(t,e){e=e||document;var n=e.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=t,e.getElementsByTagName("head")[0].appendChild(n)},inject:function(t,e){e=e||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(n)}}}(),e.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),o=t.length-1;o>=0;o--)n=[t[o].apply(this,n)];return n[0]}},each:function(e,n,o){if(t&&e.forEach===t)e.forEach(n,o);else if(e.length===e.length+0){for(var i=0,r=e.length;r>i;i++)if(i in e&&n.call(o,e[i],i)===this.BREAK)return}else for(var i in e)if(n.call(o,e[i],i)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),e.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(e.utils.common),e.dom.dom=function(t){function e(e){if("0"===e||t.isUndefined(e))return 0;var n=e.match(i);return t.isNull(n)?0:parseFloat(n[1])}var n={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},o={};t.each(n,function(e,n){t.each(e,function(t){o[t]=n})});var i=/(\d+(\.\d+)?)px/,r={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,n,o){t.isUndefined(n)&&(n=!0),t.isUndefined(o)&&(o=!0),e.style.position="absolute",n&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,n,i,r){i=i||{};var s=o[n];if(!s)throw new Error("Event type "+n+" not supported.");var a=document.createEvent(s);switch(s){case"MouseEvents":var u=i.x||i.clientX||0,l=i.y||i.clientY||0;a.initMouseEvent(n,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,u,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;t.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(n,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:a.initEvent(n,i.bubbles||!1,i.cancelable||!0)}t.defaults(a,r),e.dispatchEvent(a)},bind:function(t,e,n,o){return o=o||!1,t.addEventListener?t.addEventListener(e,n,o):t.attachEvent&&t.attachEvent("on"+e,n),r},unbind:function(t,e,n,o){return o=o||!1,t.removeEventListener?t.removeEventListener(e,n,o):t.detachEvent&&t.detachEvent("on"+e,n),r},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1==n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return r},removeClass:function(t,e){if(e)if(void 0===t.className);else if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),o=n.indexOf(e);-1!=o&&(n.splice(o,1),t.className=n.join(" "))}else t.className=void 0;return r},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var n=getComputedStyle(t);return e(n["border-left-width"])+e(n["border-right-width"])+e(n["padding-left"])+e(n["padding-right"])+e(n.width)},getHeight:function(t){var n=getComputedStyle(t);return e(n["border-top-width"])+e(n["border-bottom-width"])+e(n["padding-top"])+e(n["padding-bottom"])+e(n.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return r}(e.utils.common),e.controllers.OptionController=function(t,e,n){var o=function(t,i,r){o.superclass.call(this,t,i);var s=this;if(this.__select=document.createElement("select"),n.isArray(r)){var a={};n.each(r,function(t){a[t]=t}),r=a}n.each(r,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),s.__select.appendChild(n)}),this.updateDisplay(),e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;s.setValue(t)}),this.domElement.appendChild(this.__select)};return o.superclass=t,n.extend(o.prototype,t.prototype,{setValue:function(t){var e=o.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),o.superclass.prototype.updateDisplay.call(this)}}),o}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.NumberController=function(t,e){function n(t){return t=t.toString(),t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var o=function(t,i,r){o.superclass.call(this,t,i),r=r||{},this.__min=r.min,this.__max=r.max,this.__step=r.step,this.__impliedStep=e.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step,this.__precision=n(this.__impliedStep)};return o.superclass=t,e.extend(o.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&t%this.__step!=0&&(t=Math.round(t/this.__step)*this.__step),o.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__step=t,this}}),o}(e.controllers.Controller,e.utils.common),e.controllers.NumberControllerBox=function(t,e,n){function o(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var i=function(t,o,r){function s(){var t=parseFloat(h.__input.value);n.isNaN(t)||h.setValue(t)}function a(){s(),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function u(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),d=t.clientY}function l(t){var e=d-t.clientY;h.setValue(h.getValue()+e*h.__impliedStep),d=t.clientY}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c)}this.__truncationSuspended=!1,i.superclass.call(this,t,o,r);var d,h=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",s),e.bind(this.__input,"blur",a),e.bind(this.__input,"mousedown",u),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1)
}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=t,n.extend(i.prototype,t.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():o(this.getValue(),this.__precision),i.superclass.prototype.updateDisplay.call(this)}}),i}(e.controllers.NumberController,e.dom.dom,e.utils.common),e.controllers.NumberControllerSlider=function(t,e,n,o,i){function r(t,e,n,o,i){return o+(i-o)*((t-e)/(n-e))}var s=function(t,n,o,i,a){function u(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),l(t)}function l(t){t.preventDefault();var n=e.getOffset(d.__background),o=e.getWidth(d.__background);return d.setValue(r(t.clientX,n.left,n.left+o,d.__min,d.__max)),!1}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}s.superclass.call(this,t,n,{min:o,max:i,step:a});var d=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",u),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return s.superclass=t,s.useDefaultStyles=function(){n.inject(i)},o.extend(s.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",s.superclass.prototype.updateDisplay.call(this)}}),s}(e.controllers.NumberController,e.dom.dom,e.utils.css,e.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),e.controllers.FunctionController=function(t,e,n){var o=function(t,n,i){o.superclass.call(this,t,n);var r=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,e.bind(this.__button,"click",function(t){return t.preventDefault(),r.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return o.superclass=t,n.extend(o.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),o}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.BooleanController=function(t,e,n){var o=function(t,n){function i(){r.setValue(!r.__prev)}o.superclass.call(this,t,n);var r=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",i,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return o.superclass=t,n.extend(o.prototype,t.prototype,{setValue:function(t){var e=o.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,o.superclass.prototype.updateDisplay.call(this)}}),o}(e.controllers.Controller,e.dom.dom,e.utils.common),e.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(e.utils.common),e.color.interpret=function(t,e){var n,o,i=function(){o=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(r,function(i){return i.litmus(t)?(e.each(i.conversions,function(i,r){return n=i.read(t),o===!1&&n!==!1?(o=n,n.conversionName=r,n.conversion=i,e.BREAK):void 0}),e.BREAK):void 0}),o},r=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return i}(e.color.toString,e.utils.common),e.GUI=e.gui.GUI=function(t,e,n,o,i,r,s,a,u,l,c,d,h,p,f){function _(t,e,n,r){if(void 0===e[n])throw new Error("Object "+e+' has no property "'+n+'"');var s;if(r.color)s=new c(e,n);else{var a=[e,n].concat(r.factoryArgs);s=o.apply(t,a)}r.before instanceof i&&(r.before=r.before.__li),y(t,s),p.addClass(s.domElement,"c");var u=document.createElement("span");p.addClass(u,"property-name"),u.innerHTML=s.property;var l=document.createElement("div");l.appendChild(u),l.appendChild(s.domElement);var d=m(t,l,r.before);return p.addClass(d,P.CLASS_CONTROLLER_ROW),p.addClass(d,typeof s.getValue()),g(t,d,s),t.__controllers.push(s),s}function m(t,e,n){var o=document.createElement("li");return e&&o.appendChild(e),n?t.__ul.insertBefore(o,params.before):t.__ul.appendChild(o),t.onResize(),o}function g(t,e,n){if(n.__li=e,n.__gui=t,f.extend(n,{options:function(e){return arguments.length>1?(n.remove(),_(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[f.toArray(arguments)]})):f.isArray(e)||f.isObject(e)?(n.remove(),_(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof u){var o=new a(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});f.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=n[t],i=o[t];n[t]=o[t]=function(){var t=Array.prototype.slice.call(arguments);return e.apply(n,t),i.apply(o,t)}}),p.addClass(e,"has-slider"),n.domElement.insertBefore(o.domElement,n.domElement.firstElementChild)}else if(n instanceof a){var i=function(e){return f.isNumber(n.__min)&&f.isNumber(n.__max)?(n.remove(),_(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):e};n.min=f.compose(i,n.min),n.max=f.compose(i,n.max)}else n instanceof r?(p.bind(e,"click",function(){p.fakeEvent(n.__checkbox,"click")}),p.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof s?(p.bind(e,"click",function(){p.fakeEvent(n.__button,"click")}),p.bind(e,"mouseover",function(){p.addClass(n.__button,"hover")}),p.bind(e,"mouseout",function(){p.removeClass(n.__button,"hover")})):n instanceof c&&(p.addClass(e,"color"),n.updateDisplay=f.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=f.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&C(t.getRoot(),!0),e},n.setValue)}function y(t,e){var n=t.getRoot(),o=n.__rememberedObjects.indexOf(e.object);if(-1!=o){var i=n.__rememberedObjectIndecesToControllers[o];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[o]=i),i[e.property]=e,n.load&&n.load.remembered){var r,s=n.load.remembered;if(s[t.preset])r=s[t.preset];else{if(!s[O])return;r=s[O]}if(r[o]&&void 0!==r[o][e.property]){var a=r[o][e.property];e.initialValue=a,e.setValue(a)}}}}function v(t,e){return document.location.href+"."+e}function b(t){function e(){l.style.display=t.useLocalStorage?"block":"none"}var n=t.__save_row=document.createElement("li");p.addClass(t.domElement,"has-save"),t.__ul.insertBefore(n,t.__ul.firstChild),p.addClass(n,"save-row");var o=document.createElement("span");o.innerHTML="&nbsp;",p.addClass(o,"button gears");var i=document.createElement("span");i.innerHTML="Save",p.addClass(i,"button"),p.addClass(i,"save");var r=document.createElement("span");r.innerHTML="New",p.addClass(r,"button"),p.addClass(r,"save-as");var s=document.createElement("span");s.innerHTML="Revert",p.addClass(s,"button"),p.addClass(s,"revert");var a=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?f.each(t.load.remembered,function(e,n){k(t,n,n==t.preset)}):k(t,O,!1),p.bind(a,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),n.appendChild(a),n.appendChild(o),n.appendChild(i),n.appendChild(r),n.appendChild(s),L){var u=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");u.style.display="block";var c=document.getElementById("dg-local-storage");"true"===localStorage.getItem(v(t,"isLocal"))&&c.setAttribute("checked","checked"),e(),p.bind(c,"change",function(){t.useLocalStorage=!t.useLocalStorage,e()})}var d=document.getElementById("dg-new-constructor");p.bind(d,"keydown",function(t){!t.metaKey||67!==t.which&&67!=t.keyCode||R.hide()}),p.bind(o,"click",function(){d.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),R.show(),d.focus(),d.select()}),p.bind(i,"click",function(){t.save()}),p.bind(r,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),p.bind(s,"click",function(){t.revert()})}function w(t){function e(e){return e.preventDefault(),i=e.clientX,p.addClass(t.__closeButton,P.CLASS_DRAG),p.bind(window,"mousemove",n),p.bind(window,"mouseup",o),!1}function n(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function o(){p.removeClass(t.__closeButton,P.CLASS_DRAG),p.unbind(window,"mousemove",n),p.unbind(window,"mouseup",o)}t.__resize_handle=document.createElement("div"),f.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var i;p.bind(t.__resize_handle,"mousedown",e),p.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function x(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function E(t,e){var n={};return f.each(t.__rememberedObjects,function(o,i){var r={},s=t.__rememberedObjectIndecesToControllers[i];f.each(s,function(t,n){r[n]=e?t.initialValue:t.getValue()}),n[i]=r}),n}function k(t,e,n){var o=document.createElement("option");o.innerHTML=e,o.value=e,t.__preset_select.appendChild(o),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function A(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value==t.preset&&(t.__preset_select.selectedIndex=e)}function C(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function T(t){0!=t.length&&d(function(){T(t)}),f.each(t,function(t){t.updateDisplay()})}t.inject(n);var R,S,H="dg",j=72,M=20,O="Default",L=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),B=!0,N=!1,F=[],P=function(t){function e(){localStorage.setItem(v(o,"gui"),JSON.stringify(o.getSaveObject()))}function n(){var t=o.getRoot();t.width+=1,f.defer(function(){t.width-=1})}var o=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),p.addClass(this.domElement,H),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=f.defaults(t,{autoPlace:!0,width:P.DEFAULT_WIDTH}),t=f.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),f.isUndefined(t.load)?t.load={preset:O}:t.preset&&(t.load.preset=t.preset),f.isUndefined(t.parent)&&t.hideable&&F.push(this),t.resizable=f.isUndefined(t.parent)&&t.resizable,t.autoPlace&&f.isUndefined(t.scrollable)&&(t.scrollable=!0);var i=L&&"true"===localStorage.getItem(v(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return o.parent?o.getRoot().preset:t.load.preset},set:function(e){o.parent?o.getRoot().preset=e:t.load.preset=e,A(this),o.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,x(o,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,s&&(s.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?p.addClass(o.__ul,P.CLASS_CLOSED):p.removeClass(o.__ul,P.CLASS_CLOSED),this.onResize(),o.__closeButton&&(o.__closeButton.innerHTML=e?P.TEXT_OPEN:P.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return i},set:function(t){L&&(i=t,t?p.bind(window,"unload",e):p.unbind(window,"unload",e),localStorage.setItem(v(o,"isLocal"),t))}}}),f.isUndefined(t.parent)){if(t.closed=!1,p.addClass(this.domElement,P.CLASS_MAIN),p.makeSelectable(this.domElement,!1),L&&i){o.useLocalStorage=!0;var r=localStorage.getItem(v(this,"gui"));r&&(t.load=JSON.parse(r))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=P.TEXT_CLOSED,p.addClass(this.__closeButton,P.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),p.bind(this.__closeButton,"click",function(){o.closed=!o.closed})}else{void 0===t.closed&&(t.closed=!0);var s=document.createTextNode(t.name);p.addClass(s,"controller-name");var a=m(o,s),u=function(t){return t.preventDefault(),o.closed=!o.closed,!1};p.addClass(this.__ul,P.CLASS_CLOSED),p.addClass(a,"title"),p.bind(a,"click",u),t.closed||(this.closed=!1)}t.autoPlace&&(f.isUndefined(t.parent)&&(B&&(S=document.createElement("div"),p.addClass(S,H),p.addClass(S,P.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(S),B=!1),S.appendChild(this.domElement),p.addClass(this.domElement,P.CLASS_AUTO_PLACE)),this.parent||x(o,t.width)),p.bind(window,"resize",function(){o.onResize()}),p.bind(this.__ul,"webkitTransitionEnd",function(){o.onResize()}),p.bind(this.__ul,"transitionend",function(){o.onResize()}),p.bind(this.__ul,"oTransitionEnd",function(){o.onResize()}),this.onResize(),t.resizable&&w(this);o.getRoot();t.parent||n()};return P.toggleHide=function(){N=!N,f.each(F,function(t){t.domElement.style.zIndex=N?-999:999,t.domElement.style.opacity=N?0:1})},P.CLASS_AUTO_PLACE="a",P.CLASS_AUTO_PLACE_CONTAINER="ac",P.CLASS_MAIN="main",P.CLASS_CONTROLLER_ROW="cr",P.CLASS_TOO_TALL="taller-than-window",P.CLASS_CLOSED="closed",P.CLASS_CLOSE_BUTTON="close-button",P.CLASS_DRAG="drag",P.DEFAULT_WIDTH=245,P.TEXT_CLOSED="Close Controls",P.TEXT_OPEN="Open Controls",p.bind(window,"keydown",function(t){"text"===document.activeElement.type||t.which!==j&&t.keyCode!=j||P.toggleHide()},!1),f.extend(P.prototype,{add:function(t,e){return _(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return _(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.slice(this.__controllers.indexOf(t),1);var e=this;f.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&S.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new P(e);this.__folders[t]=n;var o=m(this,n.domElement);return p.addClass(o,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=p.getOffset(t.__ul).top,n=0;f.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=p.getHeight(e))}),window.innerHeight-e-M<n?(p.addClass(t.domElement,P.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-M+"px"):(p.removeClass(t.domElement,P.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&f.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(f.isUndefined(R)&&(R=new h,R.domElement.innerHTML=e),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;f.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&b(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&x(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=E(this)),t.folders={},f.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=E(this),C(this,!1)},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[O]=E(this,!0)),this.load.remembered[t]=E(this),this.preset=t,k(this,t,!0)},revert:function(t){f.each(this.__controllers,function(e){this.getRoot().load.remembered?y(t||this.getRoot(),e):e.setValue(e.initialValue)},this),f.each(this.__folders,function(t){t.revert(t)}),t||C(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&T(this.__listening)}}),P}(e.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",e.controllers.factory=function(t,e,n,o,i,r,s){return function(a,u){var l=a[u];return s.isArray(arguments[2])||s.isObject(arguments[2])?new t(a,u,arguments[2]):s.isNumber(l)?s.isNumber(arguments[2])&&s.isNumber(arguments[3])?new n(a,u,arguments[2],arguments[3]):new e(a,u,{min:arguments[2],max:arguments[3]}):s.isString(l)?new o(a,u):s.isFunction(l)?new i(a,u,""):s.isBoolean(l)?new r(a,u):void 0}}(e.controllers.OptionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.StringController=function(t,e,n){var o=function(t,n){function i(){s.setValue(s.__input.value)}function r(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}o.superclass.call(this,t,n);var s=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",i),e.bind(this.__input,"change",i),e.bind(this.__input,"blur",r),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return o.superclass=t,n.extend(o.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),o.superclass.prototype.updateDisplay.call(this)}}),o}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.FunctionController,e.controllers.BooleanController,e.utils.common),e.controllers.Controller,e.controllers.BooleanController,e.controllers.FunctionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.OptionController,e.controllers.ColorController=function(t,e,n,o,i){function r(t,e,n,o){t.style.background="",i.each(u,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+o+" 100%); "})}function s(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var a=function(t,u){function l(t){p(t),e.bind(window,"mousemove",p),e.bind(window,"mouseup",c)}function c(){e.unbind(window,"mousemove",p),e.unbind(window,"mouseup",c)}function d(){var t=o(this.value);t!==!1?(_.__color.__state=t,_.setValue(_.__color.toOriginal())):this.value=_.__color.toString()}function h(){e.unbind(window,"mousemove",f),e.unbind(window,"mouseup",h)}function p(t){t.preventDefault();var n=e.getWidth(_.__saturation_field),o=e.getOffset(_.__saturation_field),i=(t.clientX-o.left+document.body.scrollLeft)/n,r=1-(t.clientY-o.top+document.body.scrollTop)/n;return r>1?r=1:0>r&&(r=0),i>1?i=1:0>i&&(i=0),_.__color.v=r,_.__color.s=i,_.setValue(_.__color.toOriginal()),!1}function f(t){t.preventDefault();var n=e.getHeight(_.__hue_field),o=e.getOffset(_.__hue_field),i=1-(t.clientY-o.top+document.body.scrollTop)/n;return i>1?i=1:0>i&&(i=0),_.__color.h=360*i,_.setValue(_.__color.toOriginal()),!1}a.superclass.call(this,t,u),this.__color=new n(this.getValue()),this.__temp=new n(0);var _=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&d.call(this)}),e.bind(this.__input,"blur",d),e.bind(this.__selector,"mousedown",function(){e.addClass(this,"drag").bind(window,"mouseup",function(){e.removeClass(_.__selector,"drag")})});var m=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(m.style,{width:"100%",height:"100%",background:"none"}),r(m,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),s(this.__hue_field),i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",l),e.bind(this.__field_knob,"mousedown",l),e.bind(this.__hue_field,"mousedown",function(t){f(t),e.bind(window,"mousemove",f),e.bind(window,"mouseup",h)}),this.__saturation_field.appendChild(m),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};a.superclass=t,i.extend(a.prototype,t.prototype,{updateDisplay:function(){var t=o(this.getValue());if(t!==!1){var e=!1;i.each(n.COMPONENTS,function(n){return i.isUndefined(t[n])||i.isUndefined(this.__color.__state[n])||t[n]===this.__color.__state[n]?void 0:(e=!0,{})},this),e&&i.extend(this.__color.__state,t)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,a=255-s;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,r(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+a+","+a+","+a+",.7)"})
}});var u=["-moz-","-o-","-webkit-","-ms-",""];return a}(e.controllers.Controller,e.dom.dom,e.color.Color=function(t,e,n,o){function i(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(s(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(s(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function r(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(a(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(a(this),this.__state.space="HSV"),this.__state[e]=t}})}function s(t,n,i){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,i);else{if("HSV"!==t.__state.space)throw"Corrupted color state";o.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function a(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);o.extend(t.__state,{s:n.s,v:n.v}),o.isNaN(n.h)?o.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var u=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],o.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(u.prototype,"r",2),i(u.prototype,"g",1),i(u.prototype,"b",0),r(u.prototype,"h"),r(u.prototype,"s"),r(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),u}(e.color.interpret,e.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var o=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),r=n*(1-e),s=n*(1-i*e),a=n*(1-(1-i)*e),u=[[n,a,r],[s,n,r],[r,n,a],[r,s,n],[a,r,n],[n,r,s]][o];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var o,i,r=Math.min(t,e,n),s=Math.max(t,e,n),a=s-r;return 0==s?{h:0/0,s:0,v:0}:(i=a/s,o=t==s?(e-n)/a:e==s?2+(n-t)/a:4+(t-e)/a,o/=6,0>o&&(o+=1),{h:360*o,s:i,v:s/255})},rgb_to_hex:function(t,e,n){var o=this.hex_with_component(0,2,t);return o=this.hex_with_component(o,1,e),o=this.hex_with_component(o,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,o){return o<<(t=8*n)|e&~(255<<t)}}}(),e.color.toString,e.utils.common),e.color.interpret,e.utils.common),e.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),e.dom.CenteredDiv=function(t,e){var n=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;t.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var e=this,n=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",n),t.unbind(e.domElement,"transitionend",n),t.unbind(e.domElement,"oTransitionEnd",n)};t.bind(this.domElement,"webkitTransitionEnd",n),t.bind(this.domElement,"transitionend",n),t.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},n}(e.dom.dom,e.utils.common),e.dom.dom,e.utils.common)},function(t){var e=t.exports=e||{};e.color=e.color||{},e.utils=e.utils||{},e.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),o=t.length-1;o>=0;o--)n=[t[o].apply(this,n)];return n[0]}},each:function(e,n,o){if(t&&e.forEach===t)e.forEach(n,o);else if(e.length===e.length+0){for(var i=0,r=e.length;r>i;i++)if(i in e&&n.call(o,e[i],i)===this.BREAK)return}else for(var i in e)if(n.call(o,e[i],i)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),e.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(e.utils.common),e.Color=e.color.Color=function(t,e,n,o){function i(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(s(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(s(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function r(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(a(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(a(this),this.__state.space="HSV"),this.__state[e]=t}})}function s(t,n,i){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,i);else{if("HSV"!==t.__state.space)throw"Corrupted color state";o.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function a(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);o.extend(t.__state,{s:n.s,v:n.v}),o.isNaN(n.h)?o.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var u=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],o.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(u.prototype,"r",2),i(u.prototype,"g",1),i(u.prototype,"b",0),r(u.prototype,"h"),r(u.prototype,"s"),r(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),u}(e.color.interpret=function(t,e){var n,o,i=function(){o=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(r,function(i){return i.litmus(t)?(e.each(i.conversions,function(i,r){return n=i.read(t),o===!1&&n!==!1?(o=n,n.conversionName=r,n.conversion=i,e.BREAK):void 0}),e.BREAK):void 0}),o},r=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return i}(e.color.toString,e.utils.common),e.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var o=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),r=n*(1-e),s=n*(1-i*e),a=n*(1-(1-i)*e),u=[[n,a,r],[s,n,r],[r,n,a],[r,s,n],[a,r,n],[n,r,s]][o];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var o,i,r=Math.min(t,e,n),s=Math.max(t,e,n),a=s-r;return 0==s?{h:0/0,s:0,v:0}:(i=a/s,o=t==s?(e-n)/a:e==s?2+(n-t)/a:4+(t-e)/a,o/=6,0>o&&(o+=1),{h:360*o,s:i,v:s/255})},rgb_to_hex:function(t,e,n){var o=this.hex_with_component(0,2,t);return o=this.hex_with_component(o,1,e),o=this.hex_with_component(o,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,o){return o<<(t=8*n)|e&~(255<<t)}}}(),e.color.toString,e.utils.common)},function(){}]);