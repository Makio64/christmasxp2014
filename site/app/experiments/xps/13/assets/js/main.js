!function t(e,s,i){function o(a,r){if(!s[a]){if(!e[a]){var h="function"==typeof require&&require;if(!r&&h)return h(a,!0);if(n)return n(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var p=s[a]={exports:{}};e[a][0].call(p.exports,function(t){var s=e[a][1][t];return o(s?s:t)},p,p.exports,t,e,s,i)}return s[a].exports}for(var n="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({"../.././src/scripts/app.js":[function(t,e){var s=(t("./views/AppView"),t("./experiment/experiment")),i={appView:null,experiment:null,init:function(){this.experiment=new s,this.experiment.load(),window.addEventListener("touchstart",function(t){t.preventDefault()})}};i.init(),e.exports=i},{"./experiment/experiment":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/experiment.js","./views/AppView":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/views/AppView.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/beat-cube.js":[function(t,e){var s=(t("../utils/number-utils"),function(t,e,s){THREE.Object3D.apply(this,arguments),this.originSize=t,this.currentScale=.3,this.scaleEasing=.5,this.receiveShadow=!0,this.castShadow=!0,this.attractionPoint=null,this.physicsBody=null,this.addCube(),this.speed=e,this.layer=s,this.rotationSpeed=.005*Math.random()});s.prototype=Object.create(THREE.Object3D.prototype),s.prototype.constructor=s,s.prototype.addCube=function(){var t=new THREE.LoadingManager;t.onProgress=function(t,e,s){console.log(t,e,s)};new THREE.Texture;this.texture=new THREE.Texture;var e=(new THREE.OBJLoader(t),new THREE.BoxGeometry(this.originSize,this.originSize,this.originSize)),s=new THREE.MeshPhongMaterial({color:3355443,transparency:!1,opacity:1,wireframe:!1});this.cube=new THREE.Mesh(e,s),this.cube.receiveShadow=!0,this.cube.castShadow=!0,this.add(this.cube)},s.prototype.update=function(){this.position.x-=this.speed,this.rotation.y+=this.rotationSpeed},e.exports=s},{"../utils/number-utils":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/number-utils.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/experiment.js":[function(t,e){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();var s=t("./scenes/scene"),i=t("../sound/sound-manager"),o=t("./beat-cube"),n=t("./gift");t("./santa/santa");t("../utils/dat-gui"),t("../utils/number-utils");window.deltaTime=0,window.lastTime=Date.now();var a=function(){this.width=window.innerWidth,this.height=window.innerHeight,this.scene=null,this.soundManager=null,this.santa=null,this.beatCubes=[],this.physicsBodies=[],this.maxChannel=0,this.scores=0,this.scoreContainer=document.querySelector(".score span")};a.prototype.load=function(){this.soundManager=new i,this.soundManager.load(),this.soundManager.onLoaded=function(){this.init()}.bind(this)},a.prototype.init=function(){this.scene=new s,this.scene.init(this.width,this.height),this.animFrame=requestAnimationFrame(this.animate.bind(this)),window.addEventListener("resize",this.onResize.bind(this)),this.controls=new THREE.TrackballControls(this.scene.camera,this.scene.renderer.domElement),this.addSanta()},a.prototype.addSanta=function(){this.santa=new window.Santa,this.santa.onLoaded=function(){if(!this.isLoaded){this.isLoaded=!0,this.scene.renderer.domElement.classList.add("transitionIn"),this.scene.mainScene.add(this.santa.mesh),this.addBeatCubes(),this.addRabbitGift();{this.santa.mesh.geometry.clone()}this.scene.oclScene.addSanta(this.santa)}}.bind(this)},a.prototype.addBeatCubes=function(){for(var t=0;15>t;t++){var e=7,s=[Math.floor(201*Math.random())-100,50*Math.random()+10,50*-Math.random()],i=[Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI],a=this.speed=.08*Math.random(),r=new n(e,a,0);r.position.set(s[0],s[1],s[2]),r.rotation.set(i[0],i[1],i[2]),this.scene.add(r),this.beatCubes.push(r)}for(var t=0;3>t;t++){var e=20,s=[Math.floor(201*Math.random())-100,20*Math.random()+10,40*Math.random()+20],i=[Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI],a=this.speed=Math.random()+.03,r=new o(e,a,1);r.position.set(s[0],s[1],s[2]),r.rotation.set(i[0],i[1],i[2]),this.scene.add(r),this.beatCubes.push(r)}},a.prototype.addRabbitGift=function(){this.rabbitGift=new n(10,.1,2),this.rabbitGift.position.set(25,5,0),this.scene.mainScene.add(this.rabbitGift),this.rabbitGift.onGoneCallback=this.onRabbitGiftGoneCallback.bind(this),this.rabbitGift.onNopCallback=this.onRabbitGiftNopCallback.bind(this)},a.prototype.animate=function(){this.animFrame=requestAnimationFrame(this.animate.bind(this)),this.deltaTime=Date.now()-this.lastTime,this.lastTime=Date.now(),this.update(),this.render()},a.prototype.update=function(){this.santa.isLoaded&&(this.scene.update(this.soundManager.channels,this.santa),this.soundManager.update(),this.santa.isLoaded&&(this.santa.update(this.rabbitGift),this.rabbitGift.update()))},a.prototype.render=function(){this.scene.render()},a.prototype.onRabbitGiftGoneCallback=function(){this.scores++,this.updateScore()},a.prototype.onRabbitGiftNopCallback=function(){this.scores--,this.updateScore(),this.scene.activateGlitch(),this.santa.mesh.position.x=-40,TweenMax.to(this.rabbitGift.scale,.1,{x:2*Math.random(),y:2*Math.random(),z:2*Math.random()}),TweenMax.to(this.rabbitGift.scale,.1,{x:2*Math.random(),y:2*Math.random(),z:2*Math.random(),delay:.2}),TweenMax.to(this.rabbitGift.scale,.1,{x:2*Math.random(),y:2*Math.random(),z:2*Math.random(),delay:.3}),TweenMax.to(this.rabbitGift.scale,.1,{x:2*Math.random(),y:2*Math.random(),z:2*Math.random(),delay:.4}),TweenMax.to(this.rabbitGift.scale,.1,{x:1,y:1,z:1,delay:.5,ease:Elastic.easeOut})},a.prototype.updateScore=function(){this.scoreContainer.innerHTML=this.scores},a.prototype.onResize=function(){this.scene.camera.aspect=window.innerWidth/window.innerHeight,this.scene.camera.updateProjectionMatrix(),this.scene.renderer.setSize(window.innerWidth,window.innerHeight)},e.exports=a},{"../sound/sound-manager":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/sound/sound-manager.js","../utils/dat-gui":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/dat-gui.js","../utils/number-utils":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/number-utils.js","./beat-cube":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/beat-cube.js","./gift":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/gift.js","./santa/santa":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/santa/santa.js","./scenes/scene":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/scenes/scene.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/gift.js":[function(t,e){var s=t("../utils/number-utils"),i=function(t){THREE.Object3D.apply(this,arguments),this.size=t,this.red=[214,40,34],this.green=[2,115,15],this.rgb={r:this.green[0],g:this.green[1],b:this.green[2]};var e=new THREE.PlaneBufferGeometry(1.5,this.size),s=new THREE.MeshBasicMaterial({color:"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")",side:THREE.DoubleSide}),i=new THREE.Mesh(e,s),o=new THREE.PlaneBufferGeometry(.5,this.size),n=new THREE.MeshBasicMaterial({color:16604755,side:THREE.DoubleSide}),a=new THREE.Mesh(o,n);a.position.set(-1,0,0);var r=new THREE.Mesh(o,n);r.position.set(1,0,0),this.add(i),this.add(a),this.add(r)};i.prototype=Object.create(THREE.Object3D.prototype),i.prototype.constructor=i;var o=function(t,e,s){THREE.Object3D.apply(this,arguments),this.size=t,this.canBeTaken=!0,this.red=[214,40,34],this.green=[2,115,15],this.rgb={r:this.green[0],g:this.green[1],b:this.green[2]},this.time=0,this.nextAvailabilitySwitch=90,this.rotationSpeed=.005,this.speed=e,this.layer=s,this.isGoing=!1,this.stripScale=1;var o=new THREE.BoxGeometry(this.size,this.size,this.size),n=new THREE.MeshLambertMaterial({color:16777215}),a=new THREE.Mesh(o,n);this.stripFront=new i(this.size),this.stripFront.position.set(0,0,this.size/2+.01),this.stripBack=new i(this.size),this.stripBack.position.set(0,0,-(this.size/2)-.01),this.stripLeft=new i(this.size),this.stripLeft.position.set(-(this.size/2)-.01,0,0),this.stripLeft.rotation.set(0,Math.PI/2,0),this.stripRight=new i(this.size),this.stripRight.position.set(this.size/2+.01,0,0),this.stripRight.rotation.set(0,Math.PI/2,0),this.stripTop1=new i(this.size),this.stripTop1.position.set(0,this.size/2+.01,0),this.stripTop1.rotation.set(Math.PI/2,0,0),this.stripTop2=new i(this.size),this.stripTop2.position.set(0,this.size/2+.01,0),this.stripTop2.rotation.set(Math.PI/2,0,Math.PI/2),this.stripBottom1=new i(this.size),this.stripBottom1.position.set(0,-(this.size/2)-.01,0),this.stripBottom1.rotation.set(Math.PI/2,0,0),this.stripBottom2=new i(this.size),this.stripBottom2.position.set(0,-(this.size/2)-.01,0),this.stripBottom2.rotation.set(Math.PI/2,0,Math.PI/2),this.add(a),2===this.layer&&(this.add(this.stripFront),this.add(this.stripBack),this.add(this.stripLeft),this.add(this.stripRight),this.add(this.stripTop1),this.add(this.stripTop2),this.add(this.stripBottom1),this.add(this.stripBottom2))};o.prototype=Object.create(THREE.Object3D.prototype),o.prototype.constructor=o,o.prototype.update=function(){2===this.layer?(this.time+=16,this.time>=this.nextAvailabilitySwitch&&(this.time=0,this.toggleAvailabily(),this.nextAvailabilitySwitch=Math.floor(this.canBeTaken?4e3*Math.random():3e3*Math.random())),this.rotation.x+=this.rotationSpeed,this.rotation.y+=this.rotationSpeed,this.rotation.z+=this.rotationSpeed):(this.position.x-=this.speed,this.rotation.y+=this.rotationSpeed)},o.prototype.toggleAvailabily=function(){this.canBeTaken=!this.canBeTaken;var t=[],e=1;this.canBeTaken?t=this.green:(t=this.red,e=.7),this.sizeTween=new TweenMax(this.scale,1,{x:e,y:e,z:e,ease:Elastic.easeInOut}),this.stripFront.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")"),this.stripBack.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")"),this.stripLeft.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")"),this.stripRight.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")"),this.stripTop1.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")"),this.stripTop2.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")"),this.stripBottom1.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")"),this.stripBottom2.children[0].material.color.setStyle("rgb("+t[0]+","+t[1]+","+t[2]+")")},o.prototype.onColorUpdate=function(){s.map(this.rgb.r,0,255,0,1),s.map(this.rgb.g,0,255,0,1),s.map(this.rgb.b,0,255,0,1)},o.prototype.onCollision=function(t){t?(this.isGoing=!0,TweenMax.to(this.position,1.5,{y:15,ease:Power4.easeInOut}),TweenMax.to(this.scale,.3,{x:1e-4,y:1e-4,z:1e-4,delay:1.5,ease:Elastic.easeOut,delay:2}),TweenMax.to(this,1.5,{stripScale:1e-4,onUpdate:this.onStripScaleUpdate.bind(this),onComplete:this.onGone.bind(this),delay:1}),TweenMax.to(this.rotation,1.5,{x:6*Math.PI,y:Math.PI,z:Math.random()*Math.PI,ease:Power4.easeOut})):(this.isGoing=!0,this.onNopCallback(),this.isGoing=!1)},o.prototype.onStripScaleUpdate=function(){this.stripFront.scale.y=this.stripScale,this.stripBack.scale.y=this.stripScale,this.stripLeft.scale.y=this.stripScale,this.stripRight.scale.y=this.stripScale,this.stripTop1.scale.y=this.stripScale,this.stripTop2.scale.y=this.stripScale,this.stripBottom1.scale.y=this.stripScale,this.stripBottom2.scale.y=this.stripScale},o.prototype.onGone=function(){console.log("gone"),this.isGoing=!1;var t=(Math.random()<.5?-1:1,40*Math.random());this.position.set(t,5,0),TweenMax.to(this.scale,1,{x:1,y:1,z:1,delay:1,ease:Elastic.easeOut}),this.stripScale=1,this.onStripScaleUpdate(),this.onGoneCallback(this)},o.prototype.onNopCallback=function(){},e.exports=o},{"../utils/number-utils":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/number-utils.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/santa/santa.js":[function(t){var e=t("../../utils/dat-gui");window.Santa,__bind=function(t,e){return function(){return t.apply(e,arguments)}},Santa=function(){function t(){this.update=__bind(this.update,this),this.load(),this.animStep=[],this.time=0,this.currentStep=0,this.wind=-.2,this.impulsion=0,this.canBeTaken=!0,this.timerCanBeTaken=null,this.thighLTo=0,this.shinLTo=0,this.thighRTo=0,this.shinRTo=0,this.moveEasing=1.1}return t.prototype.dae=null,t.prototype.skin=null,t.prototype.mesh=null,t.prototype.hips=null,t.prototype.chest=null,t.prototype.neck=null,t.prototype.load=function(){console.log("obj");var t;return t=new THREE.JSONLoader,t.load("./assets/models/santa/santa.js",function(t){return function(e,s){return t.mesh=new THREE.SkinnedMesh(e,new THREE.MeshFaceMaterial(s)),t.mesh.rotation.y=Math.PI,t.mesh.material.materials.forEach(function(e){e.skinning=!0,e.color.setRGB(1.5,1.5,1.5),t.mesh.traverse(function(t){return t.castShadow=!0,t.receiveShadow=!1}),t.mesh.position.set(0,-7,0),t.mesh.rotation.set(0,Math.PI/2,0),t.mesh.scale.x=t.mesh.scale.y=t.mesh.scale.z=2.5,t.setBonesReferences(),t.onLoaded()})}}(this)),null},t.prototype.onLoaded=function(){return null},t.prototype.onKeyUp=function(t){32===t.keyCode&&(this.impulsion+=.2,this.wind+=.2)},t.prototype.onTouch=function(){this.impulsion+=.2,this.wind+=.2},t.prototype.setBonesReferences=function(){if(!this.isLoaded){window.addEventListener("keyup",this.onKeyUp.bind(this)),window.addEventListener("touchstart",this.onTouch.bind(this)),this.isLoaded=!0,this.hips=this.mesh.children[0],this.spine=this.mesh.skeleton.bones[0].children[0],this.chest=this.mesh.skeleton.bones[1].children[0],this.neck=this.mesh.skeleton.bones[2].children[0],this.head=this.mesh.skeleton.bones[4],this.shoulderL=this.mesh.skeleton.bones[6],this.upperArmL=this.mesh.skeleton.bones[7],this.foreArmL=this.mesh.skeleton.bones[8],this.handL=this.mesh.skeleton.bones[9],this.shoulderR=this.mesh.skeleton.bones[29],this.upperArmR=this.mesh.skeleton.bones[30],this.foreArmR=this.mesh.skeleton.bones[31],this.handR=this.mesh.skeleton.bones[32],this.thighL=this.mesh.skeleton.bones[52],this.shinL=this.mesh.skeleton.bones[53],this.footL=this.mesh.skeleton.bones[54],this.toeL=this.mesh.skeleton.bones[55],this.heelL=this.mesh.skeleton.bones[56],this.thighR=this.mesh.skeleton.bones[58],this.shinR=this.mesh.skeleton.bones[59],this.footR=this.mesh.skeleton.bones[60],this.toeR=this.mesh.skeleton.bones[61],this.heelR=this.mesh.skeleton.bones[62],this.bodyPieces=[{name:"hips",el:this.hips,defaultEl:this.hips},{name:"spine",el:this.spine,defaultEl:this.spine},{name:"chest",el:this.chest,defaultEl:this.chest},{name:"neck",el:this.neck,defaultEl:this.neck},{name:"head",el:this.head,defaultEl:this.head},{name:"shoulderL",el:this.shoulderL,defaultEl:this.shoulderL},{name:"upperArmL",el:this.upperArmL,defaultEl:this.upperArmL},{name:"foreArmL",el:this.foreArmL,defaultEl:this.foreArmL},{name:"handL",el:this.handL,defaultEl:this.handL},{name:"shoulderR",el:this.shoulderR,defaultEl:this.shoulderR},{name:"upperArmR",el:this.upperArmR,defaultEl:this.upperArmR},{name:"foreArmR",el:this.foreArmR,defaultEl:this.foreArmR},{name:"handR",el:this.handR,defaultEl:this.handR},{name:"thighL",el:this.thighL,defaultEl:this.thighL},{name:"shinL",el:this.shinL,defaultEl:this.shinL},{name:"footL",el:this.footL,defaultEl:this.footL},{name:"toeL",el:this.toeL,defaultEl:this.toeL},{name:"heelL",el:this.heelL,defaultEl:this.heelL},{name:"thighR",el:this.thighR,defaultEl:this.thighR},{name:"shinR",el:this.shinR,defaultEl:this.shinR},{name:"footR",el:this.footR,defaultEl:this.footR},{name:"toeR",el:this.toeR,defaultEl:this.toeR},{name:"heelR",el:this.spheelRine,defaultEl:this.spheelRine}];for(var t=0;t<this.bodyPieces.length;t++){var s=this.bodyPieces[t];s.el&&(e.santaSettings[s.name]={position:{x:s.el.position.x,y:s.el.position.y,z:s.el.position.z},rotation:{x:s.el.rotation.x,y:s.el.rotation.y,z:s.el.rotation.z}})}e.santaSettings.hips.position.y=4.8,e.santaSettings.hips.rotation.x=1,e.santaSettings.head.rotation.x=-1,e.santaSettings.shoulderL.rotation.x=.7,e.santaSettings.shoulderL.rotation.z=-1,e.santaSettings.shoulderR.rotation.x=.7,e.santaSettings.shoulderR.rotation.z=1,e.santaSettings.thighL.rotation.x=0,e.santaSettings.shinL.rotation.x=1,e.santaSettings.thighR.rotation.x=-1,e.santaSettings.shinR.rotation.x=0,this.setAnimationSteps()}},t.prototype.setAnimationSteps=function(){this.animationSteps=[[{name:"hips"}]]},t.prototype.goToStep=function(t){0===t?(this.thighLTo=0,this.shinLTo=1,this.thighRTo=-1,this.shinRTo=0):1===t&&(this.thighLTo=-1,this.shinLTo=this.bodyPieces[14].defaultEl.rotation.x,this.thighRTo=-1,this.shinRTo=1)},t.prototype.update=function(t){for(var s=0;s<this.bodyPieces.length;s++){var i=this.bodyPieces[s];i.el&&(i.el.position.x=e.santaSettings[i.name].position.x,i.el.position.y=e.santaSettings[i.name].position.y,i.el.position.z=e.santaSettings[i.name].position.z,i.el.rotation.x=e.santaSettings[i.name].rotation.x,i.el.rotation.y=e.santaSettings[i.name].rotation.y,i.el.rotation.z=e.santaSettings[i.name].rotation.z)}this.thighL.rotation.x+=(this.thighLTo-this.thighL.rotation.x)*this.moveEasing,this.shinL.rotation.x+=(this.shinLTo-this.shinL.rotation.x)*this.moveEasing,this.thighR.rotation.x+=(this.thighRTo-this.thighR.rotation.x)*this.moveEasing,this.shinR.rotation.x+=(this.shinRTo-this.shinR.rotation.x)*this.moveEasing,this.time+=16,this.time>=80&&(this.time=0,this.currentStep++,this.currentStep>1&&(this.currentStep=0),this.goToStep(this.currentStep),this.impulsion-=.1,this.impulsion<=0&&(this.impulsion=0),this.wind-=.8,this.wind<=-.3&&(this.wind=-.3)),this.mesh.position.x<=-40?this.mesh.position.x=-40:this.mesh.position.x>=40&&(this.mesh.position.x=40),this.mesh.position.x+=this.wind,this.mesh.position.x+=this.impulsion,this.mesh.position.x>=t.position.x-13&&this.mesh.position.x<=t.position.x+10&&!t.isGoing&&t.onCollision(t.canBeTaken)},t}()},{"../../utils/dat-gui":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/dat-gui.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/scenes/occlusion-scene.js":[function(t,e){var s=t("../../shaders/shaders"),i=t("../../utils/dat-gui"),o=function(){this.width=0,this.height=0,this.scene=null,this.camera=null,this.renderTarget=null,this.renderer=null,this.composer=null,this.vLight=null,this.oclMeshes=[],this.santa=null};o.prototype.init=function(t,e,s,i){this.width=t,this.height=e,this.scene=new THREE.Scene,this.camera=i,this.renderer=s;var o={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBufer:!1};this.renderTarget=new THREE.WebGLRenderTarget(this.width,this.height,o),this.addVLights(),this.initPostProcessing()},o.prototype.addBox=function(t){this.scene.add(t)},o.prototype.addSanta=function(t){if(!this.santa){this.santa=t.mesh.clone();var e=new THREE.Mesh(this.santa.geometry,new THREE.MeshBasicMaterial({wireframe:!1,color:0,side:THREE.DoubleSide}));e.rotation.set(0,Math.PI/2,0),e.position.y=-4,console.log(this.santa.geometry)}},o.prototype.addShape=function(t,e){var s=new THREE.MeshBasicMaterial({color:0,side:THREE.DoubleSide}),i=new THREE.Mesh(t,s);i.position.set(e[0],e[1],e[2]),this.scene.add(i)},o.prototype.remove=function(){},o.prototype.addVLights=function(){var t=new THREE.SphereGeometry(60),e=new THREE.MeshBasicMaterial({color:16669493});this.vLight=new THREE.Mesh(t,e),this.vLight.position.set(0,0,-100),this.vLight.rotation.set(0,0,0),this.scene.add(this.vLight)},o.prototype.initPostProcessing=function(){i.shadersSettings.godray={color:"#fc6a3d",fX:.5,fY:.5,fExposure:.77,fDecay:.93,fDensity:.96,fWeight:.07,fClamp:1};var t=i.addFolder("God ray");t.addColor(i.shadersSettings.godray,"color").onChange(this.onColorChange.bind(this)),t.add(i.shadersSettings.godray,"fX",-1,1),t.add(i.shadersSettings.godray,"fY",0,1),t.add(i.shadersSettings.godray,"fExposure",0,1),t.add(i.shadersSettings.godray,"fDecay",0,1),t.add(i.shadersSettings.godray,"fDensity",0,1),t.add(i.shadersSettings.godray,"fWeight",0,1),t.add(i.shadersSettings.godray,"fClamp",0,1),this.composer=new THREE.EffectComposer(this.renderer,this.renderTarget);var e=new THREE.RenderPass(this.scene,this.camera);this.composer.addPass(e),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.composer.addPass(this.copyPass),this.grPass=new THREE.ShaderPass(s.godray),this.composer.addPass(this.grPass),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.composer.addPass(this.copyPass);var o=new THREE.ShaderPass(THREE.HorizontalBlurShader),n=new THREE.ShaderPass(THREE.VerticalBlurShader);o.uniforms.h.value=4/this.width,n.uniforms.v.value=4/this.height,this.composer.addPass(o),this.composer.addPass(n),this.composer.addPass(o),this.composer.addPass(n),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.composer.addPass(this.copyPass),this.copyPass.renderToScreen=!0},o.prototype.onColorChange=function(){this.vLight.material.color.setHex(i.shadersSettings.godray.color.replace("#","0x"))},o.prototype.resize=function(t,e){this.width=t,this.height=e,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix()},o.prototype.update=function(){this.grPass.uniforms.fX.value=i.shadersSettings.godray.fX,this.grPass.uniforms.fY.value=i.shadersSettings.godray.fY,this.grPass.uniforms.fExposure.value=i.shadersSettings.godray.fExposure,this.grPass.uniforms.fDecay.value=i.shadersSettings.godray.fDecay,this.grPass.uniforms.fDensity.value=i.shadersSettings.godray.fDensity,this.grPass.uniforms.fWeight.value=i.shadersSettings.godray.fWeight,this.grPass.uniforms.fClamp.value=i.shadersSettings.godray.fClamp},o.prototype.render=function(){this.renderer.setClearColor(0),this.composer.render()},e.exports=o},{"../../shaders/shaders":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/shaders/shaders.js","../../utils/dat-gui":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/dat-gui.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/scenes/scene.js":[function(t,e){var s=t("./occlusion-scene"),i=t("../../shaders/shaders"),o=t("../../utils/dat-gui"),n=function(){this.width=0,this.height=0,this.mainScene=null,this.camera=null,this.renderer=null,this.oclScene=null,this.physicsScene=null,this.beatCubes=[],this.beatCubeOcl=[],this.oclMeshes=[],this.physicsBodys=[],this.backgroundColor=13421772,this.glitch={isActive:!1,timeout:null,pass:null}};n.prototype.init=function(t,e){this.width=t,this.height=e,this.mainScene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(45,this.width/this.height,.1,1e4),this.camera.position.set(0,20,170),this.renderer=new THREE.WebGLRenderer,this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(this.backgroundColor),this.renderer.shadowMapEnabled=!1,this.renderer.shadowMapType=THREE.PCFSoftShadowMap,document.querySelector("#app").appendChild(this.renderer.domElement),this.addLights(),this.oclScene=new s,this.oclScene.init(this.width,this.height,this.renderer,this.camera),this.initPostProcessing(),this.buildScene();for(var i=0;30>i;i++);this.renderer.shadowMapSoft=!0,this.renderer.shadowCameraNear=3,this.renderer.shadowCameraFar=this.camera.far,this.renderer.shadowCameraFov=50,this.renderer.shadowMapBias=.0039,this.renderer.shadowMapDarkness=.5,this.renderer.shadowMapWidth=2048,this.renderer.shadowMapHeight=2048,o.cameraSettings={position:{x:0,y:50,z:0},rotation:{x:0,y:0,z:0}}},n.prototype.addLights=function(){this.ambientLight=new THREE.AmbientLight(0),this.mainScene.add(this.ambientLight),o.spotLightSettings={intensity:.7,position:{x:0,y:200,z:-50},rotation:{x:0,y:0,z:0}},this.spotLight=new THREE.SpotLight(16777215),this.spotLight.castShadow=!0,this.spotLight.position.set(0,105,-180),this.spotLight.shadowCameraVisible=!0,this.spotLight.shadowDarkness=.35,this.spotLight.shadowMapWidth=2048,this.spotLight.shadowMapHeight=2048,this.spotLight.intensity=1,this.dirLight=new THREE.DirectionalLight(16777215),this.mainScene.add(this.dirLight),this.dirLight.intensity=.3},n.prototype.add=function(t){this.mainScene.add(t),this.beatCubes.push(t);var e=t.children[0].geometry.clone(),s=new THREE.MeshBasicMaterial({wireframe:!1,color:0,side:THREE.DoubleSide}),i=new THREE.Mesh(e,s);i.position.set(t.position.x,t.position.y,t.position.z),i.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),this.oclScene.addBox(i),this.beatCubeOcl.push(i)},n.prototype.addCube=function(t){t.originSize,[t.position.x,t.position.y,t.position.z],[t.rotation.x,t.rotation.y,t.rotation.z];this.mainScene.add(t),this.beatCubes.push(t);var e=t.cube.geometry;this.oclScene.add(e,t.position,t.rotation)},n.prototype.buildScene=function(){var t=new THREE.CircleGeometry(320,100),e=new THREE.MeshBasicMaterial({wireframe:!1,color:0,side:THREE.DoubleSide,map:null}),s=[0,-321,10],i=[0,0,0];this.floor=new THREE.Mesh(t,e),this.floor.position.y=s[1],this.floor.position.z=s[2],this.floor.receiveShadow=!0,this.mainScene.add(this.floor),this.oclScene.addShape(t.clone(),s,i)},n.prototype.remove=function(t){this.mainScene.remove(t)},n.prototype.initPostProcessing=function(){this.composer=new THREE.EffectComposer(this.renderer),this.renderPass=new THREE.RenderPass(this.mainScene,this.camera),this.composer.addPass(this.renderPass),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.composer.addPass(this.copyPass),this.vignettePass=new THREE.ShaderPass(THREE.VignetteShader),this.composer.addPass(this.vignettePass),this.glowPass=new THREE.ShaderPass(i.additive),this.glowPass.uniforms.tDiffuse2.value=this.oclScene.renderTarget,this.composer.addPass(this.glowPass);var t={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1};this.savedRenderTarget=new THREE.WebGLRenderTarget(this.width,this.height,t),this.savePass=new THREE.SavePass(this.savedRenderTarget),this.composer.addPass(this.savePass),this.glitch.pass=new THREE.GlitchPass,this.composer.addPass(this.glitch.pass),this.glitch.pass.randX=0,this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.composer.addPass(this.copyPass),this.copyPass.renderToScreen=!0},n.prototype.activateGlitch=function(){this.glitch.isActive||(clearTimeout(this.glitch.timeout),this.glitch.isActive=!0,this.glitch.timeout=setTimeout(function(){this.glitch.isActive=!1}.bind(this),800))},n.prototype.update=function(){this.updateGUI(),this.oclScene.update();{var t;new THREE.Matrix4}this.glitch.pass.randX=this.glitch.isActive?5:0;for(var e=this.beatCubes.length;e--;){t=this.beatCubes[e],t.update(this.camera);var s=this.beatCubeOcl[e];s.position.set(t.position.x,t.position.y,t.position.z),s.rotation.set(t.rotation.x,t.rotation.y,t.rotation.z),t.position.x<=-120&&(0===t.layer?(t.speed=.08*Math.random(),t.position.y=50*Math.random()+10,t.position.z=50*-Math.random(),t.position.x=120,t.rotationSpeed=.005*Math.random()):(t.position.y=20*Math.random()+10,t.position.z=40*Math.random()+20,t.speed=.5+Math.random(),t.position.x=120+50*Math.random(),t.rotationSpeed=.05*Math.random()+.03))}},n.prototype.updateGUI=function(){this.spotLight.intensity=o.spotLightSettings.intensity,this.spotLight.position.set(o.spotLightSettings.position.x,o.spotLightSettings.position.y,o.spotLightSettings.position.z),this.spotLight.rotation.set(o.spotLightSettings.rotation.x,o.spotLightSettings.rotation.y,o.spotLightSettings.rotation.z)},n.prototype.render=function(){this.oclScene.render(),this.renderer.setClearColor(0),this.composer.render()},n.prototype.resize=function(t,e){this.width=t,this.height=e,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height),this.composer.setSize(this.width,this.height),this.occlusion.resize(this.width,this.height)},e.exports=n},{"../../shaders/shaders":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/shaders/shaders.js","../../utils/dat-gui":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/dat-gui.js","./occlusion-scene":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/experiment/scenes/occlusion-scene.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/shaders/shaders.js":[function(t,e){var s={additive:{uniforms:{tDiffuse:{type:"t",value:null},tDiffuse2:{type:"t",value:null}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","vec4 texel1 = texture2D( tDiffuse, vUv );","vec4 texel2 = texture2D( tDiffuse2, vUv );","gl_FragColor = texel1 + vec4(0.5, 0.75, 1.0, 1.0) * texel2 * 2.0;","}"].join("\n")},godray:{uniforms:{tDiffuse:{type:"t",value:0,texture:null},fX:{type:"f",value:.5},fY:{type:"f",value:.5},fExposure:{type:"f",value:.6},fDecay:{type:"f",value:.93},fDensity:{type:"f",value:.96},fWeight:{type:"f",value:.4},fClamp:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tDiffuse;","uniform float fX;","uniform float fY;","uniform float fExposure;","uniform float fDecay;","uniform float fDensity;","uniform float fWeight;","uniform float fClamp;","const int iSamples = 20;","void main() {","vec2 deltaTextCoord = vec2(vUv - vec2(fX,fY));","deltaTextCoord *= 1.0 /  float(iSamples) * fDensity;","vec2 coord = vUv;","float illuminationDecay = 1.0;","vec4 FragColor = vec4(0.0);","for(int i=0; i < iSamples ; i++)","{","coord -= deltaTextCoord;","vec4 texel = texture2D(tDiffuse, coord);","texel *= illuminationDecay * fWeight;","FragColor += texel;","illuminationDecay *= fDecay;","}","FragColor *= fExposure;","FragColor = clamp(FragColor, 0.0, fClamp);","gl_FragColor = FragColor;","}"].join("\n")}};e.exports=s},{}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/sound/sound-manager.js":[function(t,e){var s=t("../utils/dat-gui"),i=function(){this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.analyser=this.audioCtx.createAnalyser(),this.muteBtn=document.querySelector(".mute"),this.mainBuffer=null,this.audioSource=null,this.channels=[],this.currentTime=0,this.isMuted=!1,this.isLoaded=!1,s.soundSettings={play:!0,loop:!0,playbackRate:1},this.muteBtn.addEventListener("click",this.toggleSound.bind(this))};i.prototype.load=function(){var t="./assets/sounds/alice.mp3",e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){this.isLoaded=!0,this.onLoaded(),this.audioCtx.decodeAudioData(e.response,function(t){this.mainBuffer=t,this.gainNode=this.audioCtx.createGain(),this.play()}.bind(this))}.bind(this),e.send()},i.prototype.play=function(){this.audioSource=this.audioCtx.createBufferSource(),this.audioSource.buffer=this.mainBuffer,this.audioSource.start(this.currentTime),this.audioSource.loop=!0,this.audioSource.playbackRate=1,this.audioSource.connect(this.gainNode),this.gainNode.connect(this.analyser),this.analyser.connect(this.audioCtx.destination)},i.prototype.togglePlay=function(){s.soundSettings.play?this.play():(this.currentTime=this.audioSource.context.currentTime,this.audioSource.stop())},i.prototype.updateSettings=function(){this.audioSource&&(this.audioSource.loop=s.soundSettings.loop,this.audioSource.playbackRate.value=s.soundSettings.playbackRate)},i.prototype.update=function(){this.audioSource&&(this.channels=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.getByteFrequencyData(this.channels),this.currentTime=this.audioSource.context.currentTime)},i.prototype.toggleSound=function(){this.isMuted=!this.isMuted,this.isMuted?(this.muteBtn.classList.remove("unmute-mode"),this.muteBtn.classList.add("mute-mode"),this.gainNode.gain.value=0):(this.muteBtn.classList.remove("mute-mode"),this.muteBtn.classList.add("unmute-mode"),this.gainNode.gain.value=1)
},i.prototype.onLoaded=function(){},i.prototype.onEnded=function(){},e.exports=i},{"../utils/dat-gui":"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/dat-gui.js"}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/dat-gui.js":[function(t,e){var s=new dat.GUI;s.spotLightSettings={},s.shadersSettings={},s.santaSettings={},s.domElement.style.display="none",e.exports=s},{}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/utils/number-utils.js":[function(t,e){var s={rgb2hex:function(t,e,s){var i=s|e<<8|t<<16;return"#"+(16777216+i).toString(16).slice(1)},map:function(t,e,s,i,o,n){var n=n||!1;return num1=(t-e)/(s-e),num2=num1*(o-i)+i,n?Math.round(num2):num2}};e.exports=s},{}],"/Users/william.mapan/Documents/perso/xmas14/src/scripts/views/AppView.js":[function(t,e){var s=function(){};e.exports=s},{}]},{},["../.././src/scripts/app.js"]);